<!doctype html>
<html lang="id" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="theme-color" content="#343a40">
	<link rel="dns-prefetch" href="https://cdnjs.cloudflare.com/">
	<link rel="icon" href="assets/icon.png" type="image/x-icon">
	<meta name="description" content="Visualisasi data COVID-19 NTT dari 22 Kabupaten/Kota. Halaman ini menyajikan perkembangan data hari ini dari setiap Kabupaten/Kota.">
	<meta name="keywords" content="Covid, Corona, Covid NTT, Covid19">
	<meta name="author" content="Jolly Frankle">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="referrer" content="no-referrer-when-downgrade">
	<meta http-equiv='cache-control' content='no-cache'>
	<meta http-equiv='expires' content='0'>
	<meta http-equiv='pragma' content='no-cache'>
	<title>JFP – Data Per Wilayah</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css" onload="if(media!='all')media='all'">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;400;500;700&display=swap" onload="if(media!='all')media='all'">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-167603452-2"></script>
<script>
window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'UA-167603452-2');
</script>
	<style>
body{font-family:"Roboto",sans-serif;}.logoinc::before,.logodec::before,.logonet::before{display:inline-block;font-size:14px;margin-right:.25rem}.logoinc::before{content:"▲"}.logodec::before{content:"▼"}.logonet::before{content:"–"}.logoright::before{margin-right:0;margin-left:.25rem;width:1rem;text-align:center}.card{overflow:hidden}.anchor{position:absolute;margin-top:-3.5rem;}#TP_TblHarian td:nth-child(2),#TP_TblHarian td:nth-child(4),#TP_TblHarian td:nth-child(6),#TP_TblHarian td:nth-child(8) {border-left:1px solid #dee2e6}.tbl-iti{width:24px;height:24px;margin-left:.25rem}.flbet{display:flex;justify-content:space-between;align-items:center}.info-kasus small{display:inline-block;width:80px}#ClosedCasesToday,#NewCasesToday, #SembCasesToday{padding-left:1.25rem;margin-bottom:0;list-style-type:square}.fw-500{font-weight:500}
#TambahanInfo {z-index: 1079; position: sticky; bottom: 0; max-height: 20vh; overflow-y: auto; margin-bottom: 0;}
#MapContainer{height:500px; max-height:75vh; cursor: grab} #MapContainer:active {cursor: grabbing;}
#MapContainer svg{overflow:auto; width:100%}
#MapContainer svg path{cursor:pointer}
#MapLegend{z-index:1;position:absolute;left:.5rem;bottom:.5rem;width:250px}
#MapNav .dropdown-item { padding: .2rem .75rem; font-size: .875rem; }
#MapNav .dropdown-header { padding: .3rem .75rem }
#MapNav{position:absolute;bottom:.5rem;right:.5rem;width:300px;z-index:0;white-space:nowrap;display:flex}
#MapHeader{position:absolute;top:.5rem;left:.5rem;right:.5rem;margin-bottom:0;z-index: 1;text-align: center;line-height:1.25}
#MapIndLeg{position: absolute;bottom: 3rem;right: .5rem;width:300px;user-select:none}
#MapIndLeg>div {line-height:1;display:flex;justify-content:space-between;position:relative;font-size:80%}
#MapIndLeg>div span:nth-child(2){position:absolute;width:100%;text-align:center}
#MapIndCol{height:.5rem;border-radius:.25rem}
#MapMobileNav{display:none}
/*.ping-shake{animation:shake .75s cubic-bezier(.36,.07,.19,.97)}
@keyframes shake{10%,90%{transform:translateX(-1px)}20%,80%{transform:translateX(3px)}30%,50%,70%{transform:translateX(-6px)}40%,60%{transform:translateX(6px)}}*/
.chart-container{position:relative; min-width:100%; max-width:100%; margin-bottom:1rem;}
.chart-container div{position:absolute;width:100%;height:100%;text-align:center;display:flex;align-items:center;justify-content:center;background: var(--light)}
.outline-white {text-shadow: -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff, 1px 1px 0 #fff;}
@media (max-width: 767.98px) {
	#MapLegend{position:static;border-radius:0;width:calc(100% + 2px);margin:0 -1px;overflow:hidden}
	#MapContainer{max-height:275px;height:50vh}
	#MapIndLeg {position:static;width:calc(100% - 9rem);margin:-1.5rem .5rem .5rem 8.5rem}
	#MapNav{position:static;width:100%;margin: -2.5rem .5rem 1rem}
	#MapMobileNav{display:block;position:absolute;right:.5rem;bottom:276px;width:54px;text-align:right}
	#MapNav .input-group{display: none}
}
#MapContainer::-webkit-scrollbar{display: none;}
@media (max-width:576px) {.chart-container{max-height:45vh;}}
</style>
</head>
<body>
	<div class="justify-content-center align-items-center position-fixed" style="width:100vw;height:100vh;background:rgba(0,0,0,.5);top:0;left:0;display:flex;z-index:1080;user-select:none" id="spinner_loader">
		<div class="text-center text-white">
			<div class="spinner-grow text-white" style="width:5rem; height: 5rem" role="status">
				<span class="sr-only">Memuat...</span>
			</div>
			<noscript>
				<h6 class="mb-1 mt-3 px-3">JavaScript Anda tidak aktif</h6>
				<div class="px-3">Halaman ini tidak dapat dimuat tanpa JavaScript</div>
			</noscript>
		</div>
	</div>
	<nav class="navbar navbar-dark shadow bg-dark">
		<div class="container d-md-flex justify-content-between text-center">
			<a class="navbar-brand text-truncate">
				JollyFrankle Projects: COVID-19 NTT Tracker
			</a>
			<div class="d-none d-md-block text-light">
				Data terakhir: <strong class="last_data">Memuat...</strong>
			</div>
		</div>
	</nav>
	<main class="container my-4">
<div class="d-block d-md-flex justify-content-between align-items-center mb-2">
	<div class="text-center text-md-left">
		<h1>COVID-19 NTT Tracker</h1>
		<p class="mb-2">Informasi dan analisa kasus COVID-19 NTT.</p>
	</div>
</div>

<nav class="mb-3 pb-3 border-bottom">
	<div class="d-block d-md-inline-flex btn-group w-100">
		<a class="btn btn-block btn-outline-dark mt-2" href="./">Ringkasan, Grafik, Tabel Pekanan</a>
		<a class="btn btn-block btn-outline-dark active">Data hari ini per Kab/Kota</a>
		<a class="btn btn-block btn-outline-dark" href="harian.html">Perkembangan data harian</a>
		<a class="btn btn-block btn-outline-info" href="data-wil.html"><span class="badge badge-info">Prototype</span> Tren kasus per Wilayah</a>
	</div>
</nav>
<div class="btn-group w-100 mb-2">
	<button class="btn btn-sm btn-outline-danger" data-toggle="collapse" data-target="#ILL_atas" aria-expanded="false" aria-controls="ILL_atas">Disklaimer</button>
	<button class="btn btn-sm btn-outline-info" data-toggle="collapse" data-target="#InfoAtas" aria-expanded="false" aria-controls="InfoAtas">Informasi, daftar isi, halaman lain</button>
</div>
<div class="collapse" id="ILL_atas">
	<div class="alert alert-danger text-justify">
		<p><strong>DISCLAIMER:</strong> Data yang ditampilkan pada halaman ini mungkin berbeda dengan data yang disediakan pada <a href="http://covid19.nttprov.go.id/home/data" class="alert-link">halaman resmi COVID-19 NTT</a> karena data yang direkam pada halaman ini diperbarui pada pukul 17.00-21.00 WITA, sedangkan data pada halaman resmi terkadang diperbarui lagi setelah 21.00 WITA. Selain itu, kasus sembuh dan meninggal tidak menunjukkan jumlah pasien yang sembuh/meninggal dari kasus pada tanggal tertentu, melainkan jumlah pasien yang diumumkan sembuh/meninggal pada hari itu juga.</p>
		<p class="font-italic mb-0">Contoh: Apabila seseorang dinyatakan positif pada 19 Januari 2021 dan sembuh pada 1 Februari 2021, kasus sembuh akan bertambah pada 1 Februari 2021, bukan 19 Januari 2021.</p>
		<h5 class="mb-0">HALAMAN INI HANYA VISUALISASI PERKEMBANGAN KASUS COVID-19 DI NTT</h5>
	</div>
</div>

<div class="card collapse" id="InfoAtas">
	<div class="card-body text-justify">
		<h4 class="border-bottom">Informasi</h4>
		<ul class="pl-4 mb-3">
			<li>Halaman ini memuat daftar kasus per Kabupaten/Kota dari Briefing Satuan Tugas Penanganan COVID-19 Nusa Tenggara Timur. Data mungkin tidak 100% akurat, informasi pada situs Satgas mungkin diperbarui setelah pembaruan data di sistem ini.</li>
			<li>"Jumlah kasus tuntas" yang ditampilkan di halaman ini adalah <strong>gabungan kasus sembuh dan meninggal</strong> (tidak disebutkan jumlah sembuh/meninggal, hanya disebutkan jumlah pasien yang sudah tidak lagi menjalani perawatan). Untuk informasi mengenai jumlah sembuh atau meninggal berdasarkan Kabupaten/Kota, kunjungi <a href="http://covid19.nttprov.go.id/home/data">situs resmi COVID-19 NTT</a> kemudian memilih Kabupaten/Kota sesuai keinginan Anda.</li>
		</ul>
		<h4 class="border-bottom">Daftar isi</h4>
		<div class="pl-4 mb-2">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">1.</div>
				<a class="h5 mb-1" href="#Bg1_Peta">Peta Interaktif</a>
			</div>
			Peta interaktif yang menampilkan analisis dan perbandingan data antar-Kabupaten/Kota di Nusa Tenggara Timur.
		</div>
		<div class="pl-4 mb-2">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">2.1</div>
				<a class="h5 mb-1" href="#Bg21_Baru">Penambahan Kasus Baru</a>
			</div>
			Penambahan kasus baru per <span class="tgl_data"></span> di wilayah Nusa Tenggara Timur.
		</div>
		<div class="pl-4 mb-2">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">2.2</div>
				<a class="h5 mb-1" href="#Bg22_Tuntas">Penambahan Kasus Tuntas</a>
			</div>
			Penambahan kasus tuntas (sembuh dan meninggal, tanpa dispesifikasi sembuh atau meninggal) per <span class="tgl_data"></span> di wilayah Nusa Tenggara Timur.
		</div>
		<div class="pl-4 mb-2">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">3.</div>
				<a class="h5 mb-1" href="#Bg3_Grafik">Grafik Perbandingan</a>
			</div>
			Perbandingan kasus aktif dan tuntas dari berbagai wilayah di Nusa Tenggara Timur.
		</div>
		<div class="pl-4">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">4.</div>
				<span class="h5 mb-1">Perubahan kasus hari ini per wilayah:</span>
			</div>
		</div>
		<ul id="TOC" style="column-width:185px;margin-left:1.5rem;padding-left:1.25rem;margin-bottom:1rem;display:none"></ul>
		<h4 class="border-bottom">Halaman lain</h4>
		<div class="pl-4 mb-2">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">1.</div>
				<a class="h5 mb-1" href="index.html">Beranda: Analisis dan grafik COVID-19 NTT</a>
			</div>
			Tersedia analisis harian, rekapitulasi data pekanan, dan grafik visualisasi perkembangan kasus COVID-19 Nusa Tenggara Timur.
		</div>
		<div class="pl-4">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">2.</div>
				<a class="h5 mb-1" href="harian.html">Perkembangan Kasus</a>
			</div>
			Perkembangan kasus hari-demi-hari di Nusa Tenggara Timur.
		</div>
	</div>
</div>

<div class="alert alert-warning d-block d-md-flex align-items-center text-justify my-2">
	<div class="text-center mb-4 my-md-0 mt-2">
		<svg xmlns="http://www.w3.org/2000/svg" width="96" height="96" fill="currentColor" viewBox="0 0 16 16"><path d="M4 11a1 1 0 1 1 2 0v1a1 1 0 1 1-2 0v-1zm6-4a1 1 0 1 1 2 0v5a1 1 0 1 1-2 0V7zM7 9a1 1 0 0 1 2 0v3a1 1 0 1 1-2 0V9z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg>
	</div>
	<div class="w-100 ml-0 ml-md-4">
		<h5>Sumber data: Situs Resmi Satgas Provinsi, Satgas Kabupaten, dan Rilis Resmi Satgas Provinsi.</h5>
		<p class="mb-2">Untuk menjamin akurasi data, telah dilakukan sinkronisasi manual dengan sumber data di luar situs resmi COVID-19 NTT. Sinkronisasi manual akan dilakukan hingga data dari Kab/Kota tersebut sudah cukup sinkron kembali dengan data situs COVID-19 NTT.</p>
		<p class="mb-2 fw-500">INFO: Rilis data harian mulai ditampilkan untuk publik sekitar pukul 17.00 setiap hari.</p>
		<p class="small mb-1">Pengumuman ini ditampilkan untuk tidak menimbulkan kebingungan antara data pada situs ini dengan data pada Satgas Provinsi.</p>
		<p class="mb-0"><a class="alert-link" href="sumber-data.html">Informasi lebih lanjut mengenai sumber data, klik di sini</a>.</p>
	</div>
</div>

<div class="rounded bg-white shadow overflow-hidden p-3 text-center my-3 d-block d-md-flex align-items-center justify-content-between">
	<div class="mb-2 mb-md-0 fw-500 text-md-left">Tampilkan data untuk tanggal:</div>
	<div id="sel_tgl" class="m-n1 text-md-right"></div>
</div>

<div id="Bg1_Peta" class="anchor"></div>
<div class="position-relative rounded overflow-hidden shadow mb-3">
	<h6 id="MapHeader" class="outline-white">
		<div id="MapTitle">Memuat Peta...</div>
		<div class="small text-muted">Perhatikan skala di bawah peta untuk konteks</div>
	</h6>
	<div id="MapContainer" style="background:#C6ECFF" data-zoom-on-wheel="zoom-amount: 0.002; min-scale: 1; max-scale: 5;" data-pan-on-drag >
	</div>
	<div id="MapIndLeg">
		<div>
			<span>0</span> <span>50</span> <span>100</span>
		</div>
		<div id="MapIndCol"></div>
	</div>
	<div id="MapMobileNav">
		<div class="btn-group-vertical mb-1">
			<button class="btn btn-sm btn-secondary map-zoom w-100" data-zoom="in">+</button>
			<button class="btn btn-sm btn-secondary map-zoom w-100" data-zoom="out">–</button>
		</div>
		<button class="btn btn-sm btn-secondary" type="button" onclick="svgPanZoomContainer.resetScale(document.getElementById('MapContainer'))">Reset</button>
	</div>
	<div id="MapNav">
		<div class="btn-group dropup">
			<button type="button" class="btn btn-dark btn-sm dropdown-toggle mr-2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Tampilan Data</button>
			<div class="dropdown-menu">
				<h6 class="dropdown-header flbet">Jumlah Kasus<i class="small fas fa-user-plus"></i></h6>
				<button class="dropdown-item" data-mapdata="2">Jumlah kasus per wilayah</button>
				<button class="dropdown-item" data-mapdata="1">Penambahan kasus baru</button>
				<div class="dropdown-divider my-1"></div>
				<h6 class="dropdown-header flbet">Kasus Aktif<i class="small fas fa-user-tag"></i></h6>
				<button class="dropdown-item" data-mapdata="4">Jumlah kasus aktif</button>
				<button class="dropdown-item" data-mapdata="3">Persentase kasus aktif</button>
				<div class="dropdown-divider my-1"></div>
				<h6 class="dropdown-header flbet">Kasus Tuntas<i class="small fas fa-user-check"></i></h6>
			</div>
		</div>
		<div class="input-group-sm input-group">
			<div class="btn-group input-group-prepend">
				<button class="btn btn-sm btn-secondary map-zoom px-2" data-zoom="in">+</button>
				<button class="btn btn-sm btn-secondary map-zoom px-2" data-zoom="out">–</button>
			</div>
			<input type="number" class="form-control" id="MapScale" value="100" min="100" step="1.00" max="" oninput="window.inputting=true;svgPanZoomContainer.setScale(document.getElementById('MapContainer'),+this.value/100)"/>
			<div class="input-group-append">
				<button class="btn btn-sm btn-secondary" type="button" onclick="svgPanZoomContainer.resetScale(document.getElementById('MapContainer'))">Reset</button>
			</div>
		</div>
	</div>
	<div id="MapLegend" class="card">
		<div class="pb-1 bg-secondary"></div>
		<div class="card-body small py-2 px-3">
			<h6 class="mb-0" id="LegIn_Kab">Klik pada salah satu Kab/Kota</h6>
			<div class="mb-2" id="LegIn_PerKs"></div>
			<hr class="my-1"/>
			<div class="d-flex justify-content-between">
				<span>Jumlah kasus</span>
				<strong id="LegIn_Jlh">...</strong>
			</div>
			<div class="d-flex justify-content-between">
				<span>Kasus aktif</span>
				<strong id="LegIn_Akt">...</strong>
			</div>
			<hr class="my-1"/>
			<div class="d-flex justify-content-between">
				<span>Persen kasus aktif</span>
				<strong id="LegIn_PerAkt">...</strong>
			</div>
			<div class="d-flex justify-content-between">
				<span>Persen kasus tuntas</span>
				<strong id="LegIn_PerTun">...</strong>
			</div>
			<hr class="my-1"/>
			<div class="d-flex justify-content-between">
				<span>Kasus positif baru</span>
				<strong id="LegIn_Num">...</strong>
			</div>
			<div class="d-flex justify-content-between">
				<span>Kasus tuntas baru</span>
				<strong id="LegIn_Tun">...</strong>
			</div>
			<hr class="my-1"/>
			<a class="d-block" href="#Bg4_Kasus" id="LegIn_DatiAnchor">Selengkapnya...</a>
		</div>
	</div>
</div>

<div class="alert alert-info text-center" style="position:sticky;top:0;z-index:9">
	<div class="d-inline-block">Data harian <strong class="tgl_data">Memuat...</strong>,</div>
	<div class="d-inline-block">Terakhir diperbarui <strong class="LastMod">Memuat...</strong></div>
</div>

<div class="row">
	<div class="col-md-6 mb-3">
		<div class="anchor" id="Bg21_Baru"></div>
		<div class="overflow-hidden rounded shadow h-100">
			<div class="pb-1" style="background:#BF9000"></div>
			<div class="card-body">
				<h5 class="card-title mb-1">Penambahan kasus positif</h5>
				<p class="mb-1 text-muted">Kasus terkonfirmasi baru per <span class="tgl_data">Memuat...</span>.</p>
				<hr class="my-2"/>
				<div class="font-weight-bold flbet" style="color:#BF9000">Nusa Tenggara Timur <span id="KonfIncNTT"></span></div>
				<ul id="NewCasesToday"><div class="bg-light rounded py-4 px-3 text-center">Memuat...</div></ul>
			</div>
		</div>
	</div>
	<div class="col-md-6 mb-3">
		<div class="anchor" id="Bg22_Tuntas"></div>
		<div class="overflow-hidden rounded shadow h-100">
			<div class="d-flex">
				<div class="pb-1 w-50" style="background:#002060"></div>
				<div class="pb-1 w-50" style="background:#C00000"></div>
			</div>
			<div class="card-body">
				<h5 class="card-title mb-1">Penambahan kasus <span id="h_tuntas">tuntas (gabungan)</span></h5>
				<p class="mb-1 text-muted"><span id="sub_tuntas">Gabungan ks. tuntas baru</span> per <span class="tgl_data">Memuat...</span>.</p>
				<hr class="my-2"/>
				<div class="font-weight-bold flbet" style="color:#002060">Nusa Tenggara Timur <span id="SembIncNTT"></span></div>
				<div id="SembCasesWrapper" style="display: none">
					<ul id="SembCasesToday" class="mb-2"><div class="bg-light rounded py-2 px-3 text-center">Memuat...</div></ul>
				</div>
				<div class="font-weight-bold flbet" style="color:#C00000">Nusa Tenggara Timur <span id="MengIncNTT"></span></div>
				<ul id="ClosedCasesToday"><div class="bg-light rounded py-2 px-3 text-center">Memuat...</div></ul>
			</div>
		</div>
	</div>
</div>
<div class="small pb-3 text-muted text-center" id="disclaimer_tuntas">Data kasus tuntas yang ditampilkan di halaman ini adalah <strong>gabungan kasus sembuh dan meninggal</strong> (tidak disebutkan jumlah sembuh/meninggal, hanya disebutkan jumlah pasien yang sudah tidak lagi menjalani perawatan). Untuk informasi mengenai jumlah sembuh atau meninggal berdasarkan Kabupaten/Kota, kunjungi <a href="http://covid19.nttprov.go.id/home/data">situs resmi COVID-19 NTT</a> kemudian memilih Kabupaten/Kota sesuai keinginan Anda.</div>

<div id="Bg3_Grafik" class="anchor"></div>
<h4 class="text-center mb-1 mt-2">Perbandingan Kasus Positif</h4>
<p class="text-center text-muted mb-0">Klik pada teks legenda (di atas grafik, di bawah tulisan ini) untuk menyaring data yang tampil.</p>
<div class="chart-container" style="height:500px;width:600px;">
	<div class="rounded">Memuat grafik...</div>
	<canvas id="c_konf"></canvas>
</div>

<div class="text-center d-block d-md-flex justify-content-between align-items-center pb-3">
	<div class="fw-500">Perbandingan kasus Kontak Erat, Suspek, dan Probable</div>
	<a data-toggle="collapse" href="#col_grafik" aria-expanded="false" aria-controls="col_grafik" class="btn btn-sm btn-outline-dark fw-500">Tampilkan</a>
</div>
<div class="collapse" id="col_grafik">
	<h6 class="text-center mb-0">Perbandingan Kasus Probable</h6>
	<div class="chart-container" style="height:500px;width:600px;">
		<div>Memuat grafik (berurutan)...</div>
		<canvas id="c_prob"></canvas>
	</div>

	<h6 class="text-center mb-0">Perbandingan Kasus Suspek</h6>
	<div class="chart-container" style="height:500px;width:600px;">
		<div>Memuat grafik (berurutan)...</div>
		<canvas id="c_susp"></canvas>
	</div>

	<h6 class="text-center mb-0">Perbandingan Kasus Kontak Erat</h6>
	<div class="chart-container" style="height:500px;width:600px;">
		<div>Memuat grafik (berurutan)...</div>
		<canvas id="c_kont"></canvas>
	</div>
</div>

<div id="Bg4_Kasus" class="anchor"></div>
<div class="mt-3 p-3 p-md-4 rounded mb-4 shadow d-block d-sm-flex align-items-center justify-content-between bg-white">
	<div class="text-center text-sm-left">
		<div class="display-2 text-secondary d-block d-sm-none mb-3"><i class="fas fa-map-marked-alt"></i></div>
		<h2 class="display-4 mb-3" style="font-size: 2.65rem">Rincian wilayah</h2>
		<div class="input-group mx-auto mx-sm-0" style="max-width: 400px">
			<select class="custom-select" id="selDati2">
				<option value="" selected disabled>Pilih Kab/Kota...</option>
			</select>
			<div class="input-group-append">
				<button id="selDati2_show" class="btn btn-dark">Tampilkan</button>
			</div>
		</div>
	</div>
	<div class="d-none d-sm-block overflow-hidden my-n3 my-md-n4 mr-n3 mr-md-n4 position-relative" style="line-height: 0">
		<div class="my-n3" style="transform: rotate(15deg); font-size: 17rem; color: #c6c8ca"><i class="fas fa-shield-virus"></i></div>
	</div>
</div>
<section id="iD2_wrapper" class="shadow bg-white rounded position-relative overflow-hidden" style="display: none">
<div class="position-absolute bg-light align-items-center justify-content-center text-secondary" id="iD2_loader" style="z-index: 1100; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; display: flex">
	<div class="spinner-border" role="status">
		<span class="sr-only">Memuat...</span>
	</div>
</div>
<div class="p-3 position-relative overflow-hidden">
	<div style="position: absolute; top: 1rem; right: 1rem; opacity: .5; pointer-events: none; user-select: none;">
		<img id="iD2_logo" src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/79/Lambang_Kabupaten_Belu.jpg/200px-Lambang_Kabupaten_Belu.jpg" style="width: 200px; max-width: 40vw" />
	</div>
	<div style="position: absolute; bottom: -2rem; right: -1rem; font-size: 8rem; line-height: 0; color: #c6c8ca">
		<i class="fas fa-virus"></i>
	</div>
	<div class="small text-muted fw-500 outline-white position-relative">MENAMPILKAN STATISTIK UNTUK</div>
	<h4 id="iD2_kab" class="position-relative outline-white">&ndash;</h4>
	<div class="form-row">
		<div class="col-lg-4 col-md-6 mb-3">
			<div class="p-3 shadow rounded position-relative overflow-hidden h-100 bg-white" style="border-left: .25rem solid #BF9000">
				<h6 class="mb-1">Jumlah kasus positif</h6>
				<div class="display-4 mb-1 flbet">
					<span id="iD2_konf_juml">&ndash;</span>
					<i class="fas fa-user-plus small" style="color: #c6c8ca"></i>
				</div>
				<div class="flbet">
					<span><strong id="iD2_per_ks">&ndash;</strong> kasus di NTT</span>
					<div class="fw-500 diff-ks" id="iD2_konf_diff"> <i></i> <span></span> </div>
				</div>
				<div class="small">Kasus aktif: <strong id="iD2_per_ks_akt"></strong></div>
			</div>
		</div>
		<div class="col-lg-4 col-md-6 mb-3">
			<div class="rounded shadow -sm d-flex overflow-hidden align-items-center mb-3 bg-white" style="height: calc(50% - .5rem)">
				<div class="position-relative h-100" style="width: .25rem">
					<div style="position: absolute; top: 0; width: .25rem;" id="iD2_box1clr1"></div>
					<div style="position: absolute; bottom: 0; width: .25rem;" id="iD2_box1clr2"></div>
				</div>
				<div class="px-2 px-sm-3 py-2 flbet w-100">
					<div class="flbet w-100 align-items-end mr-2">
						<div style="line-height: 1">
							<span class="lead" style="font-size: 2.5rem" id="iD2_box1num">&ndash;</span>
							<span id="iD2_box1txt">&ndash;</span>
						</div>
						<div class="fw-500 diff-ks" id="iD2_box1diff"> <i></i> <span></span> </div>
					</div>
					<i class="h3 mb-0" id="iD2_box1icon" style="color: #c6c8ca"></i>
				</div>
			</div>
			<div class="rounded shadow -sm d-flex overflow-hidden align-items-center bg-white" style="height: calc(50% - .5rem)">
				<div class="position-relative h-100" style="width: .25rem">
					<div style="position: absolute; bottom: 0; width: .25rem; height:100%" id="iD2_box2clr"></div>
				</div>
				<div class="px-2 px-sm-3 py-2 flbet w-100">
					<div class="flbet w-100 align-items-end mr-2">
						<div style="line-height: 1">
							<span class="lead" style="font-size: 2.5rem" id="iD2_box2num">&ndash;</span>
							<span id="iD2_box2txt">&ndash;</span>
						</div>
						<div class="fw-500 diff-ks" id="iD2_box2diff"> <i></i> <span></span> </div>
					</div>
					<i class="h3 mb-0" id="iD2_box2icon" style="color: #c6c8ca"></i>
				</div>
			</div>
		</div>
		<div class="col-lg-4 mb-3" id="iD2_col3">
			<div class="d-block d-md-flex d-lg-block h-100 flex-row-reverse">
<style>
.box3_1 {height: calc(50% - .5rem); margin-bottom: 1rem}
.box3_2 {height: calc(50% - .5rem)}
@media (min-width: 768px) and (max-width: 991.98px) {
	.box3_1 {height: 100%; margin-bottom: 0}
	.box3_2 {height: 100%; margin-right: .75rem}
}
</style>
				<div class="rounded shadow -sm d-flex overflow-hidden align-items-center bg-white w-100 box3_1">
					<div class="position-relative h-100" style="width: .25rem">
						<div style="position: absolute; bottom: 0; width: .25rem; background: #00B050; height:100%" id="iD2_box3clr"></div>
					</div>
					<div class="px-2 px-sm-3 py-2 flbet w-100">
						<div class="flbet w-100 align-items-end mr-2">
							<div style="line-height: 1">
								<span class="lead" style="font-size: 2.5rem" id="iD2_box3num">&ndash;</span>
								<span id="iD2_box3txt">&ndash;</span>
							</div>
							<div class="fw-500 diff-ks" id="iD2_box3diff"> <i></i> <span></span> </div>
						</div>
						<i class="h3 mb-0" id="iD2_box3icon" style="color: #c6c8ca"></i>
					</div>
				</div>
				<div class="rounded shadow -sm d-flex overflow-hidden align-items-center bg-white w-100 box3_2">
					<div class="position-relative h-100" style="width: .25rem">
						<div class="bg-primary" style="position: absolute; bottom: 0; width: .25rem; height:100%"></div>
					</div>
					<div class="px-2 px-sm-3 py-2 w-100">
						<div class="flbet"><div class="small">Tingk. kesembuhan:</div><strong id="iD2_CRR">&ndash;</strong></div>
						<div class="flbet"><div class="small">Tingk. kematian:</div><strong id="iD2_CFR">&ndash;</strong></div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<h6 class="mt-2 text-center text-md-left">KASUS KONTAK ERAT, SUSPEK, DAN PROBABLE</h6>
	<div class="form-row">
		<div class="col-md-4 mb-3">
			<div class="rounded shadow overflow-hidden p-3 bg-white h-100" style="border-left: .25rem solid var(--blue)">
				<h6 class="mb-1">Kontak Erat</h6>
				<div class="flbet align-items-end mb-1">
					<div style="font-size: 2.5rem" class="display-4" id="iD2_kont_juml">&ndash;</div>
					<div class="fw-500 diff-ks" id="iD2_kont_diff"> <i></i> <span></span> </div>
				</div>
				<div class="flbet align-items-end mb-1">
					<span><strong id="iD2_kont_b1num">&ndash;</strong> dalam pengawasan</span>
					<div class="fw-500 diff-ks text-nowrap" id="iD2_kont_b1diff"> <i></i> <span></span> </div>
				</div>
				<div class="flbet align-items-end">
					<span><strong id="iD2_kont_b2num">&ndash;</strong> selesai pengawasan</span>
					<div class="fw-500 diff-ks text-nowrap" id="iD2_kont_b2diff"> <i></i> <span></span> </div>
				</div>
			</div>
		</div>
		<div class="col-md-4 mb-3">
			<div class="rounded shadow overflow-hidden p-3 bg-white h-100" style="border-left: .25rem solid var(--green)">
				<h6 class="mb-1">Suspek</h6>
				<div class="flbet align-items-end mb-1">
					<div style="font-size: 2.5rem" class="display-4" id="iD2_susp_juml">&ndash;</div>
					<div class="fw-500 diff-ks" id="iD2_susp_diff"> <i></i> <span></span> </div>
				</div>
				<div class="flbet align-items-end mb-1">
					<span><strong id="iD2_susp_b1num">&ndash;</strong> dalam pemantauan</span>
					<div class="fw-500 diff-ks text-nowrap" id="iD2_susp_b1diff"> <i></i> <span></span> </div>
				</div>
				<div class="flbet align-items-end">
					<span><strong id="iD2_susp_b2num">&ndash;</strong> selesai/meninggal</span>
					<div class="fw-500 diff-ks text-nowrap" id="iD2_susp_b2diff"> <i></i> <span></span> </div>
				</div>
			</div>
		</div>
		<div class="col-md-4 mb-3">
			<div class="rounded shadow overflow-hidden p-3 bg-white h-100" style="border-left: .25rem solid var(--orange)">
				<h6 class="mb-1">Probable</h6>
				<div class="flbet align-items-end mb-1">
					<div style="font-size: 2.5rem" class="display-4" id="iD2_prob_juml">&ndash;</div>
					<div class="fw-500 diff-ks" id="iD2_prob_diff"> <i></i> <span></span> </div>
				</div>
				<div class="flbet align-items-end mb-1">
					<span><strong id="iD2_prob_b1num">&ndash;</strong> dalam pengawasan</span>
					<div class="fw-500 diff-ks text-nowrap" id="iD2_prob_b1diff"> <i></i> <span></span> </div>
				</div>
				<div class="flbet align-items-end">
					<span><strong id="iD2_prob_b2num">&ndash;</strong> selesai/meninggal</span>
					<div class="fw-500 diff-ks text-nowrap" id="iD2_prob_b2diff"> <i></i> <span></span> </div>
				</div>
			</div>
		</div>
	</div>
	<div class="position-relative outline-white text-muted font-italic">
		* Jumlah kasus kontak erat, suspek, dan probable kemungkinan tidak merepresentasikan kondisi terkini.
	</div>
</div>
<div class="bg-light px-3 py-2 small">
	<p class="mb-0"><span class="fw-500">Sumber data</span>:</p>
	<ul id="iD2_src" style="list-style-type:square; padding-left:1rem; margin-bottom:0"></ul>
</div>
</section>

<div id="TambahanInfo" class="alert mt-4"><h6 class="mb-1" id="TI_header"></h6><p class="mb-0 small" id="TI_text"></p></div>

</main>
<footer class="bg-dark text-light">
	<div class="container p-3">
		<strong>Jolly Frankle @ GitHub</strong>
		<div class="small">Kontak: jollyfrankle3@gmail.com</div>
	</div>
</footer>
<style id="map_style"></style><style id="activewil"></style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/svg-pan-zoom-container@0.5.0"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.4.1/chart.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
<script>
const delay = ms => new Promise(res=>setTimeout(res,ms));
const NamaBulan = ["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];
const NamaHari = ["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];
const numFormat = new Intl.NumberFormat('id-ID', {maximumFractionDigits: 2});

var url = new URL(window.location.href);
var tgl = url.searchParams.get("tgl");
val_tgl = moment(tgl, 'YYYY-MM-DD', true).isValid();
tgl_c = (val_tgl && moment(tgl).isSameOrAfter('2021-02-15')) ? tgl : "terkini";

function NolAwal(num, padlen) {
	var pad_char = '0';
	var pad = new Array(1 + padlen).join(pad_char);
	return (pad + num).slice(-pad.length);
}
function DateIndo(d,mode) {var t=new Date(d);var o="";o=mode==2?NamaHari[t.getDay()]+", " : ""; o+=t.getDate()+" "+NamaBulan[t.getMonth()]+" "+t.getFullYear(); return o;}
$.ajax({
	url: "peta-ntt.svg",
	dataType: 'html',
	success: function(data){
		$("#MapContainer").prepend(data);
		var MapCon=document.getElementById('MapContainer');
		$(".map-zoom").on("click",function() {
			scale = svgPanZoomContainer.getScale(MapCon);
			if($(this).data("zoom")=="in")
				svgPanZoomContainer.setScale(MapCon, scale+(0.15*scale));
			if($(this).data("zoom")=="out")
				svgPanZoomContainer.setScale(MapCon, scale-(0.15*scale));
		});
new MutationObserver(function (mutations) {
	if (window.inputting) {
	delete window.inputting
	} else {
	mutations.forEach(function (mutation) {
		document.getElementById('MapScale').value = (Math.round(svgPanZoomContainer.getScale(mutation.target.parentElement) * 10000) / 100).toFixed(2)
	});
	}
}).observe(document.getElementById('MapContainer').firstElementChild, {
	attributes: true,
	attributeFilter: ['transform'],
});
const observer = new MutationObserver(function (mutations) {
	mutations.forEach(function (mutation) {
	console.log('scale: ', mutation.target.dataset.scale)
	});
});

observer.observe(document.getElementById('MapContainer'), {
	attributes: true,
	attributeFilter: ['data-scale'],
});

	}
});

$.ajax({
	url:'https://jf.jollycomp.com/ajax/public.php',
	data: {action: "datakab", tgl: tgl_c},
	method: "POST",
	dataType: "json",
	timeout: 5000,
	success: function(data){
		if(data.success) {
			var t = new Date(data.last_update);
			$(".LastMod").text(DateIndo(t)+", "+NolAwal(t.getHours(),2)+"."+NolAwal(t.getMinutes(),2)+"."+NolAwal(t.getSeconds(),2)+" WITA");
			$(".tgl_data").text(DateIndo(data.tgl_data));
			$(".last_data").text(DateIndo(data.last_data));
			$("#KonfIncNTT").text("+"+numFormat.format(data.ntt.konf.new)+" ks. baru");
			$("#SembIncNTT").text("+"+numFormat.format(data.ntt.semb.new)+" sembuh");
			$("#MengIncNTT").text("+"+numFormat.format(data.ntt.meng.new)+" meninggal");
			$.each(data.tgl_ok, function(k,v) {
				$("#sel_tgl").prepend('<a href="datakab.html?tgl='+v+'" class="btn btn-outline-primary m-1 '+(data.tgl_data==v ? "active" : "")+'">'+DateIndo(v)+'</a>');
			});
			//$("#spinner_loader").fadeOut(); // Pindah ke: SHORT__SPINNER_PETA
			AJAX_Complete(data);
			if(data.peng.show) {
				$("#TI_header").html(data.peng.header);
				$("#TI_text").html(data.peng.text);
				$("#TambahanInfo").addClass("alert-"+(data.peng.type ?? "info")).show();
			}
			
		}
		if(data.error) alert("[!] Data tidak dapat diambil:\n\nAlasan: "+data.text+"\n\nHubungi jollyfrankle3@gmail.com apabila Anda yakin ini kesalahan.");
	},
	error: function(data) {
		$("#spinner_loader>div").append('<h6 class="mt-3 mb-1">Data tidak dapat diambil.</h6><div class="small mb-2">Anda dapat mencoba memuat ulang halaman ini.</div><a href="javascript:location.reload()" class="btn btn-sm btn-light fw-500" draggable="false">Muat ulang</a>');
	}
});

async function AJAX_Complete(data){
function indSelKs(x,y,mode)
{
	var status=false, num=x-y, icon="fas fa-minus", color="muted";
	if(num!= 0) status = true;
	if(num < 0) icon = "fas fa-angle-double-down";
	if(num > 0) icon = "fas fa-angle-double-up";

	if(mode==1) {
		if(num < 0) color="success";
		if(num > 0) color="danger";
	}
	if(mode==2) {
		if(num < 0) color="danger";
		if(num > 0) color="success";
	}
	return [status, Math.abs(num), icon, color];
}
function compare(a,b) {
	if (a[0] > b[0]) return -1;
	if (a[0] < b[0]) return 1;
	return 0;
}
function getMinMax(arr) {
	let min = arr[0];
	let max = arr[0];
	let i = arr.length;
	while (i--) {
		min = arr[i] < min ? arr[i] : min;
		max = arr[i] > max ? arr[i] : max;
	}
	return { min, max };
}
function rgba2rgb(background, color) {
	const alpha = color[3];
	return "rgba("+Math.floor((1 - alpha) * background[0] + alpha * color[0] + 0.5)+","+
	Math.floor((1 - alpha) * background[1] + alpha * color[1] + 0.5)+","+
	Math.floor((1 - alpha) * background[2] + alpha * color[2] + 0.5)+")";
}

// Konfigurasi dasar iD2 (info Dati 2)
var show_meng = data.show_meng;
if(show_meng) {
	// Map layer
	$("#MapNav .dropdown-menu").append('<button class="dropdown-item" data-mapdata="5">Penambahan kasus sembuh</button>');
	$("#MapNav .dropdown-menu").append('<button class="dropdown-item" data-mapdata="6">Penambahan kasus meninggal</button>');
	$("#MapNav .dropdown-menu").append('<button class="dropdown-item" data-mapdata="7">Tingkat kesembuhan (CRR)</button>');
	$("#MapNav .dropdown-menu").append('<button class="dropdown-item" data-mapdata="8">Tingkat kematian (CFR)</button>');

	// Info penambahan kasus
	$("#SembCasesWrapper").show();
	$("#h_tuntas").text("tuntas (terpisah)");
	$("#sub_tuntas").text("Kasus sembuh dan meninggal baru");
	$("#disclaimer_tuntas").html('<strong>Penting untuk dipahami bersama:</strong> data yang dikumpulkan di situs ini memiliki 2 sumber, yakni Satgas Provinsi dan Satgas Kabupaten/Kota.<br/><strong>Lihat sumber data di bawah kotak boks informasi kasus per wilayah.</strong>');
	// info Dati 2
	$("#iD2_box1clr1").css({"background":"#002060", "height":"100%"});
	$("#iD2_box1clr2").css({"height":0});
	$("#iD2_box1txt").text("sembuh");
	$("#iD2_box1icon").addClass("fas fa-user-check");

	$("#iD2_box2clr").css({"background":"#C00000"});
	$("#iD2_box2txt").text("meninggal");
	$("#iD2_box2icon").addClass("fas fa-user-minus");

	$("#iD2_box3clr").css({"background":"#00B050"});
	$("#iD2_box3txt").text("aktif");
	$("#iD2_box3icon").addClass("fas fa-user-tag");
} else {
	$("#MapNav .dropdown-menu").append('<button class="dropdown-item" data-mapdata="5">Penambahan kasus tuntas</button>');
	$("#iD2_box1clr1").css({"background":"#002060", "height":"50%"});
	$("#iD2_box1clr2").css({"background":"#C00000", "height":"50%"});
	$("#iD2_box1txt").text("tuntas");
	$("#iD2_box1icon").addClass("fas fa-user-check");

	$("#iD2_box2clr").css({"background":"#00B050"});
	$("#iD2_box2txt").text("aktif");
	$("#iD2_box2icon").addClass("fas fa-user-tag");
}

var arrKonfBaru=[], arrTuntBaru=[], arrMengBaru=[], H_KonfInc=0, H_KonfJlh=0, H_PerAkt=0, H_TuntInc=0, H_AktfJlh=0, preFiltered={"konf":[],"prob":[],"susp":[],"kont":[]}, list_kab=[], H_MengInc=0, H_CRR=0, H_CFR=0;
$.each(data.dt_kab, function(k,v) {
	$("#selDati2").append('<option value="'+k+'">'+v.nama+'</option>');
	list_kab.push(v.nama);
	var SelKonfTot=v.konf.tot[0]-v.konf.tot[1], SelKonfTun=v.konf.tun[0]-v.konf.tun[1], SelKonfMen=0, ks_aktif=v.konf.tot[0]-v.konf.tun[0];
	if(v.konf.tot[0]-v.konf.tot[1] != 0)

	if(SelKonfTot) arrKonfBaru.push([SelKonfTot,v.nama]);

	if(show_meng) {
		SelKonfMen = v.konf.men[0]-v.konf.men[1];
		if(SelKonfTun-SelKonfMen!=0) arrTuntBaru.push([SelKonfTun-SelKonfMen, v.nama]);
		if(SelKonfMen) arrMengBaru.push([SelKonfMen, v.nama]);
		preFiltered["konf"].push([v.konf.tot[0], ks_aktif, v.konf.tun[0]-v.konf.men[0], v.nama, v.konf.men[0]]);
		H_MengInc = SelKonfMen < H_MengInc ? H_MengInc : SelKonfMen;
		var crr = (v.konf.tun[0]-v.konf.men[0])/v.konf.tot[0];
		H_CRR = crr < H_CRR ? H_CRR : crr;
		var cfr = v.konf.men[0]/v.konf.tot[0];
		H_CFR = cfr < H_CFR ? H_CFR : cfr;
	} else {
		if(SelKonfTun) arrTuntBaru.push([SelKonfTun,v.nama]);
		preFiltered["konf"].push([v.konf.tot[0], ks_aktif, v.konf.tun[0], v.nama]);
	}

	preFiltered["prob"].push([v.prob.tot[0], v.prob.tot[0]-v.prob.tun[0], v.prob.tun[0], v.nama]);
	preFiltered["susp"].push([v.susp.tot[0], v.susp.tot[0]-v.susp.tun[0], v.susp.tun[0], v.nama]);
	preFiltered["kont"].push([v.kont.tot[0], v.kont.tot[0]-v.kont.tun[0], v.kont.tun[0], v.nama]);

	H_KonfInc = SelKonfTot < H_KonfInc ? H_KonfInc : SelKonfTot;
	H_TuntInc = SelKonfTun < H_TuntInc ? H_TuntInc : SelKonfTun;
	H_KonfJlh = v.konf.tot[0] < H_KonfJlh ? H_KonfJlh : v.konf.tot[0];
	H_PerAkt = (ks_aktif/v.konf.tot[0]) < H_PerAkt ? H_PerAkt : (ks_aktif/v.konf.tot[0]);
	H_AktfJlh = ks_aktif < H_AktfJlh ? H_AktfJlh : ks_aktif;
});

arrKonfBaru.sort(compare); arrTuntBaru.sort(compare);
$("#NewCasesToday, #ClosedCasesToday, #SembCasesToday").html("");
if(show_meng) {
	arrMengBaru.sort(compare);
	$.each(arrMengBaru,function(key,val) {
		val0 = val[0] < 0 ? val[0] : "+"+val[0];
		$("#ClosedCasesToday").append("<li><div class='flbet'>"+val[1]+"<strong>"+val0+"</strong></div></li>");
	});
	$.each(arrTuntBaru,function(key,val) {
		val0 = val[0] < 0 ? val[0] : "+"+val[0];
		$("#SembCasesToday").append("<li><div class='flbet'>"+val[1]+"<strong>"+val0+"</strong></div></li>");
	});
} else {
	$.each(arrTuntBaru,function(key,val) {
		val0 = val[0] < 0 ? val[0] : "+"+val[0];
		$("#ClosedCasesToday").append("<li><div class='flbet'>"+val[1]+"<strong>"+val0+"</strong></div></li>");
	});
}
$.each(arrKonfBaru,function(key,val) {
	val0 = val[0] < 0 ? val[0] : "+"+val[0];
	$("#NewCasesToday").append("<li><div class='flbet'>"+val[1]+"<strong>"+val0+"</strong></div></li>");
});

const data_src = [
	"Situs Resmi Satgas Provinsi melalui website (covid19.nttprov.go.id)",
	"Rilis Satgas Kabupaten/Kota melalui Dinas Kominfo atau lembaga resmi lain",
	"Rilis Resmi Satgas Kabupaten/Kota (melalui akun atau website Satgas)",
	"Rilis Resni Satgas Provinsi melalui Juru Bicara Marius Ardu Jelamu"
];
$("#selDati2_show").on("click", function(){
	var kab_id = $("#selDati2").val();
	//console.log(kab_id);
	if(kab_id=="" || kab_id===null || kab_id<0 || kab_id>21) {
		$("#iD2_wrapper").slideUp();
		return false;
	}
	const dt=data.dt_kab[kab_id], dt_ntt=data.ntt;
	// Inisialisasi
	$("#iD2_kab").text(dt.nama);
	$(".diff-ks").removeClass("text-danger text-success");
	$(".diff-ks>i").prop("class", "");
	$(".diff-ks>span").text("");
	$("#iD2_loader").show();
	$("#iD2_logo").prop("src", "https://upload.wikimedia.org/wikipedia/commons/thumb/"+dt.logo);
	$("#iD2_logo").on("load", function(){$("#iD2_loader").fadeOut(); $("#iD2_logo").css("display", "block")});
	$("#iD2_logo").on("error", function(){$("#iD2_loader").fadeOut(); $("#iD2_logo").css("display", "none")});
	$("#iD2_src").html("");

	// Kasus Positif
	$("#iD2_konf_juml").text(numFormat.format(dt.konf.tot[0]));
	$("#iD2_per_ks").text(numFormat.format((dt.konf.tot[0]/dt_ntt.konf.tot)*100)+"%");
	$("#iD2_per_ks_akt").text(numFormat.format(((dt.konf.tot[0]-dt.konf.tun[0])/dt.konf.tot[0])*100)+"%");
	var ind = indSelKs(dt.konf.tot[0], dt.konf.tot[1], 1);
	if(ind[0]==true) {
		$("#iD2_konf_diff").addClass("text-"+ind[3]);
		$("#iD2_konf_diff>i").addClass(ind[2]); $("#iD2_konf_diff>span").text(ind[1]);
	}

	if(show_meng) {
		// Box 1 (sembuh)
		$("#iD2_box1num").text(numFormat.format(dt.konf.tun[0]-dt.konf.men[0]));
		var ind = indSelKs(dt.konf.tun[0]-dt.konf.men[0], dt.konf.tun[1]-dt.konf.men[1], 2);
		if(ind[0]==true) {
			$("#iD2_box1diff").addClass("text-"+ind[3]);
			$("#iD2_box1diff>i").addClass(ind[2]); $("#iD2_box1diff>span").text(ind[1]);
		}
		// Box 2 (meninggal)
		$("#iD2_box2num").text(numFormat.format(dt.konf.men[0]));
		var ind = indSelKs(dt.konf.men[0], dt.konf.men[1], 1);
		if(ind[0]==true) {
			$("#iD2_box2diff").addClass("text-"+ind[3]);
			$("#iD2_box2diff>i").addClass(ind[2]); $("#iD2_box2diff>span").text(ind[1]);
		}
		// Box 3 (aktif)
		$("#iD2_box3num").text(numFormat.format(dt.konf.tot[0]-dt.konf.tun[0]));
		var ind = indSelKs(dt.konf.tot[0]-dt.konf.tun[0], dt.konf.tot[1]-dt.konf.tun[1], 1);
		if(ind[0]==true) {
			$("#iD2_box3diff").addClass("text-"+ind[3]);
			$("#iD2_box3diff>i").addClass(ind[2]); $("#iD2_box3diff>span").text(ind[1]);
		}
		// CFR dan CRR
		$("#iD2_CRR").text(numFormat.format(((dt.konf.tun[0]-dt.konf.men[0])/dt.konf.tot[0])*100)+"%");
		$("#iD2_CFR").text(numFormat.format((dt.konf.men[0]/dt.konf.tot[0])*100)+"%");
	} else {
		// Box 1
		$("#iD2_box1num").text(numFormat.format(dt.konf.tun[0]));
		var ind = indSelKs(dt.konf.tun[0], dt.konf.tun[1], 1);
		if(ind[0]==true) {
			$("#iD2_box1diff").addClass("text-"+ind[3]);
			$("#iD2_box1diff>i").addClass(ind[2]); $("#iD2_box1diff>span").text(ind[1]);
		}
		// Box 2
		$("#iD2_box2num").text(numFormat.format(dt.konf.tot[0]-dt.konf.tun[0]));
		var ind = indSelKs(dt.konf.tot[0]-dt.konf.tun[0], dt.konf.tot[1]-dt.konf.tun[1], 1);
		if(ind[0]==true) {
			$("#iD2_box2diff").addClass("text-"+ind[3]);
			$("#iD2_box2diff>i").addClass(ind[2]); $("#iD2_box2diff>span").text(ind[1]);
		}
		// Box 3 & CFR-CRR --> disable
		$("#iD2_col3").css("display", "none");
	}
	// KONTAK ERAT, SUSPEK, PROBABLE
	$.each(["kont", "susp", "prob"], function(k,v) {
		$("#iD2_"+v+"_juml").text(numFormat.format(dt[v].tot[0]));
		var ind = indSelKs(dt[v].tot[0], dt[v].tot[1], 1);
		if(ind[0]==true) {
			$("#iD2_"+v+"_diff").addClass("text-"+ind[3]);
			$("#iD2_"+v+"_diff>i").addClass(ind[2]); $("#iD2_"+v+"_diff>span").text(ind[1]);
		}
		$("#iD2_"+v+"_b1num").text(numFormat.format(dt[v].tot[0]-dt[v].tun[0]));
		var ind = indSelKs(dt[v].tot[0]-dt[v].tun[0], dt[v].tot[1]-dt[v].tun[1], 1);
		if(ind[0]==true) {
			$("#iD2_"+v+"_b1diff").addClass("text-"+ind[3]);
			$("#iD2_"+v+"_b1diff>i").addClass(ind[2]); $("#iD2_"+v+"_b1diff>span").text(ind[1]);
		}
		$("#iD2_"+v+"_b2num").text(numFormat.format(dt[v].tun[0]));
		var ind = indSelKs(dt[v].tun[0], dt[v].tun[1], 2);
		if(ind[0]==true) {
			$("#iD2_"+v+"_b2diff").addClass("text-"+ind[3]);
			$("#iD2_"+v+"_b2diff>i").addClass(ind[2]); $("#iD2_"+v+"_b2diff>span").text(ind[1]);
		}
	});
	$.each(dt.src, function(k,v) {
		$("#iD2_src").append('<li>'+data_src[v]+'</li>');
	});
	$("#iD2_wrapper").slideDown();
});

var cdt2_opt={indexAxis: 'y', tooltips: {enabled: true, mode: 'index', intersect: false}, hover: {mode: "nearest", intersect: true}, scales: {x: {stacked: true}, y: {stacked: true}},
indexAxis: 'y', maintainAspectRatio: false};

//await delay(500);
//console.log(rgba2rgb([255, 255, 255], [255, 0, 0, 0.5])) // [ 255, 128, 128 ]

/*$("#SectWil").html("");
$.each(NamaKab,function(key,val) {
	// new: grafik horisontal
	new Chart(document.getElementById("c_all_"+key).getContext("2d"), {
	type: 'horizontalBar',
	data: {
		labels: ["Konfirmasi", "Probable", "Suspek", "Kont. Erat"],
		datasets: [/*{
			label: "Jumlah",
			data: [TodTot[key][3], TodTot[key][2], TodTot[key][1], TodTot[key][0]],
			borderWidth: 0,
			backgroundColor: "rgba(0,0,0,0)",
			borderColor: "rgba(0,0,0,0)",
			type: 'line',
			pointRadius: 0,
		},*
		{
			label: "Tuntas",
			data: [TodTun[key][3], TodTun[key][2], TodTun[key][1], TodTun[key][0]],
			backgroundColor: 'rgba(0,32,96,.7)',
			borderWidth: 0,
			categoryPercentage: .9,
		},
		{
			label: "Aktif",
			data: [TodAkt[key][3], TodAkt[key][2], TodAkt[key][1], TodAkt[key][0]],
			backgroundColor: "rgba(0,176,80,.7)",
			borderWidth: 0,
			categoryPercentage: .9,
			//barPercentage: 1.0
		}]
	},
	options: cdt2_opt
});
}); */
//await delay(500);
preFiltered.konf.sort(compare); preFiltered.prob.sort(compare); preFiltered.susp.sort(compare); preFiltered.kont.sort(compare);
var ur_dati2={"konf":[[],[],[],[]],"prob":[[],[],[],[]],"susp":[[],[],[],[]],"kont":[[],[],[],[]]};
$.each(["konf", "prob", "susp", "kont"], function(k1,v1) {
	$.each(preFiltered[v1], function(k,v) {
		ur_dati2[v1][0].push(v[3]); // Kabupaten 
		ur_dati2[v1][1].push(v[1]); // Aktif
		ur_dati2[v1][2].push(v[2]); // Tuntas
		if(v1=="konf" && show_meng) ur_dati2[v1][3].push(v[4]); // data meng jika boleh
	});
});
//console.log(ur_dati2);
const footer = (tooltipItems) => {
	let sum = 0;
	tooltipItems.forEach(function(tooltipItem) {sum += tooltipItem.parsed.y});
	return 'Jumlah: ' + numFormat.format(sum);
}
const c_label = function(context) {
	var label = context.dataset.label || '';
	if (label) { label += ': '; }
	if (context.parsed.y !== null) { label += numFormat.format(context.parsed.y); }
	return label;
}
var c_options={interaction: {mode: 'index', intersect: false}, plugins: {tooltip: {callbacks: {footer: footer, label: c_label}}}, scales: {x: {stacked: true}, y: {stacked: true, ticks:{beginAtZero: true}}}, maintainAspectRatio: false, aspectRatio: 1.5};

await delay(500);
function showDataPerWil(id, perc, col) {
	$("#map_style").append("#MapContainer path._data"+id+"{fill:"+rgba2rgb([255, 255, 255],[col[0], col[1], col[2], perc])+"!important}");
	$("#MapContainer path._data"+id).data("kode",id);
}
function TmplDataPeta(mode){
	var title, min=0, mid=50, max=100, col=[0,0,0];
	$("#map_style").html("");
	$("[data-mapdata]").removeClass("active");
	$("[data-mapdata='"+mode+"']").addClass("active");
	if(mode===1) {
		title="Jumlah Penambahan Kasus Baru";
		min = 0;
		mid = (H_KonfInc/2).toFixed(0); 
		max = H_KonfInc;
		col = [191,144,0];
		$.each(data.dt_kab,function(k,v){
			per=(v.konf.tot[0]-v.konf.tot[1])/H_KonfInc;
			showDataPerWil(k, per, col);
		});
	}
	if(mode===2) {
		title="Jumlah Kasus Kumulatif";
		min = 0;
		mid = (H_KonfJlh/2).toFixed(0); 
		max = H_KonfJlh;
		col = [191, 144, 0];
		$.each(data.dt_kab,function(k,v){
			per=v.konf.tot[0]/H_KonfJlh;
			showDataPerWil(k, per, col);
		});
	}
	if(mode===3) {
		title="Persentase Kasus Aktif";
		min = "0%";
		mid = numFormat.format((H_PerAkt/2)*100)+"%"; 
		max = numFormat.format(H_PerAkt*100)+"%";
		col = [192,0,0];
		$.each(data.dt_kab,function(k,v){
			per=((v.konf.tot[0]-v.konf.tun[0])/v.konf.tot[0])/H_PerAkt;
			showDataPerWil(k, per, col);
		});
	}
	/*if(mode===5) {
		title="Persentase Kasus Tuntas";
		min = numFormat.format((1-H_PerAkt)*100)+"%";
		mid = numFormat.format((((1-H_PerAkt)/2)+0.5)*100)+"%"; 
		max = "100%"
		col = [0,32,96];
		$.each(data.dt_kab,function(k,v){
			per=1-(((v.konf.tot[0]-v.konf.tun[0])/v.konf.tot[0])/H_PerAkt);
			$("#map_style").append("#MapContainer path._data"+k+"{fill:"+rgba2rgb([255, 255, 255],[0,32,96,per])+"!important}");
			$("#MapContainer path._data"+k).data("kode",k);
		});
	}*/
	if(mode===4) {
		title="Jumlah Kasus Aktif";
		min = 0;
		mid = (H_AktfJlh/2).toFixed(0);
		max = H_AktfJlh
		col = [192,0,0];
		$.each(data.dt_kab,function(k,v){
			per=(v.konf.tot[0]-v.konf.tun[0])/H_AktfJlh;
			showDataPerWil(k, per, col);
		});
	}
	if(!show_meng && mode===5) {
		title="Jumlah Penambahan Kasus Tuntas";
		min = 0;
		mid = (H_TuntInc/2).toFixed(0); 
		max = H_TuntInc;
		col = [0,32,96];
		$.each(data.dt_kab,function(k,v){
			per=(v.konf.tun[0]-v.konf.tun[1])/H_TuntInc;
			showDataPerWil(k, per, col);
		});
	}
	if(show_meng && mode===5) {
		title="Jumlah Penambahan Kasus Sembuh";
		min = 0;
		mid = ((H_TuntInc-H_MengInc)/2).toFixed(0); 
		max = H_TuntInc-H_MengInc;
		col = [40,167,69];
		$.each(data.dt_kab,function(k,v){
			per=((v.konf.tun[0]-v.konf.tun[1])-(v.konf.men[0]-v.konf.men[1]))/(H_TuntInc-H_MengInc);
			showDataPerWil(k, per, col);
		});
	}
	if(show_meng && mode===6) {
		title="Jumlah Penambahan Kasus Meninggal";
		min = 0;
		mid = (H_MengInc/2).toFixed(0); 
		max = H_MengInc;
		col = [220,53,69];
		$.each(data.dt_kab,function(k,v){
			per=(v.konf.men[0]-v.konf.men[1])/H_MengInc;
			showDataPerWil(k, per, col);
		});
	}
	if(show_meng && mode===7) {
		title="Tingkat Kesembuhan (Case Recovery Rate)";
		min = "0%";
		mid = numFormat.format((H_CRR/2)*100)+"%"; 
		max = numFormat.format(H_CRR*100)+"%";
		col = [40,167,69];
		$.each(data.dt_kab,function(k,v){
			per=((v.konf.tun[0]-v.konf.men[0])/v.konf.tot[0])/H_CRR;
			showDataPerWil(k, per, col);
		});
	}
	if(show_meng && mode===8) {
		title="Tingkat Kematian (Case Fatality Rate)";
		min = "0%";
		mid = numFormat.format((H_CFR/2)*100)+"%"; 
		max = numFormat.format(H_CFR*100)+"%";
		col = [220,53,69];
		$.each(data.dt_kab,function(k,v){
			per=((v.konf.men[0])/v.konf.tot[0])/H_CFR;
			showDataPerWil(k, per, col);
		});
	}
	$("#MapIndLeg>div>span:nth-child(1)").text(min);
	$("#MapIndLeg>div>span:nth-child(2)").text(mid);
	$("#MapIndLeg>div>span:nth-child(3)").text(max);
	$("#MapIndCol").css("background-image","linear-gradient(90deg, white, rgba("+col+"))");
	$("#MapTitle").text(title);
}
TmplDataPeta(4); // Default untuk peta = mode 3
$("[data-mapdata]").on("click",function(){
	TmplDataPeta($(this).data("mapdata"));
});
// SHORT__SPINNER_PETA
$("#spinner_loader").fadeOut();

$(document).on("click","#MapContainer svg path[class*=_data]",function(e){
	cldata = $(this).attr("class").match(/(_data)[0-9]*\w/g)[0];
	if(cldata.slice(5)) {
		kode = cldata.slice(5);
		$("#activewil").html("#MapContainer svg ."+cldata+"{filter: drop-shadow(2px 2px 0px var(--warning)) drop-shadow(-2px -2px 0 var(--warning)) drop-shadow(0 6px 0px var(--warning))}");
		var dt=data.dt_kab[kode];
		//val = list_kab[kode];
		//val = val.substr(0,4)!="Kota"?"Kab. "+val : val;
		JlhKasus = dt.konf.tot[0];
		PerKs = numFormat.format((JlhKasus/data.ntt.konf.tot)*100);
		KsAktif = dt.konf.tot[0]-dt.konf.tun[0];
		KsBaru = dt.konf.tot[0]-dt.konf.tot[1];
		KsBaru = KsBaru < 0 ? KsBaru : "+"+KsBaru;
		TunBaru = dt.konf.tun[0]-dt.konf.tun[1];
		TunBaru = TunBaru < 0 ? TunBaru : "+"+TunBaru;
		PerAkt = numFormat.format((KsAktif/JlhKasus)*100);
		PerTun = numFormat.format((1-(KsAktif/JlhKasus))*100);
		$("#LegIn_Kab").text(dt.nama);
		$("#LegIn_PerKs").text(PerKs+"% kasus di NTT");
		$("#LegIn_Jlh").text(numFormat.format(JlhKasus));
		$("#LegIn_Akt").text(numFormat.format(KsAktif));
		$("#LegIn_PerAkt").text(PerAkt+"%");
		$("#LegIn_PerTun").text(PerTun+"%");
		$("#LegIn_Tun").text(TunBaru+" kasus");
		$("#LegIn_Num").text(KsBaru+" kasus");
		$("#LegIn_DatiAnchor").prop("href","#Bg4_Kasus");
	}
});

await delay(1500);
$("#c_konf").siblings("div").remove();
var data_konf = [];
if(show_meng) {
	data_konf = [
		{label: "Meninggal", data: ur_dati2.konf[3], backgroundColor: 'rgba(192,0,0,.7)', borderWidth: 0, categoryPercentage: .9},
		{label: "Sembuh", data: ur_dati2.konf[2], backgroundColor: 'rgba(0,32,96,.7)', borderWidth: 0, categoryPercentage: .9},
		{label: "Aktif", data: ur_dati2.konf[1], backgroundColor: 'rgba(0,176,80,.7)', borderWidth: 0, categoryPercentage: .9}
	];
} else {
	data_konf = [
		{label: "Sembuh", data: ur_dati2.konf[2], backgroundColor: 'rgba(0,32,96,.7)', borderWidth: 0, categoryPercentage: .9},
		{label: "Aktif", data: ur_dati2.konf[1], backgroundColor: 'rgba(0,176,80,.7)', borderWidth: 0, categoryPercentage: .9}
	];
}
var c_konf = new Chart(document.getElementById("c_konf").getContext("2d"), {
	type: 'bar',
	data: {labels: ur_dati2.konf[0], datasets: data_konf},
	options: c_options
});

await delay(1500);
$("#c_prob").siblings("div").remove();
var c_prob = new Chart(document.getElementById("c_prob").getContext("2d"), {
	type: 'bar',
	data: {
		labels: ur_dati2.prob[0],
		datasets: [{
			label: "Tuntas",
			data: ur_dati2.prob[2],
			backgroundColor: 'rgba(0,32,96,.7)',
			borderWidth: 0,
			categoryPercentage: .9,
		},
		{
			label: "Aktif",
			data: ur_dati2.prob[1],
			backgroundColor: "rgba(0,176,80,.7)",
			borderWidth: 0,
			categoryPercentage: .9,
			//barPercentage: 1.0
		}]
	},
	options: c_options
});

await delay(1500);
$("#c_susp").siblings("div").remove();
var c_susp = new Chart(document.getElementById("c_susp").getContext("2d"), {
	type: 'bar',
	data: {
		labels: ur_dati2.susp[0],
		datasets: [{
			label: "Tuntas",
			data: ur_dati2.susp[2],
			backgroundColor: 'rgba(0,32,96,.7)',
			borderWidth: 0,
			categoryPercentage: .9,
		},
		{
			label: "Aktif",
			data: ur_dati2.susp[1],
			backgroundColor: "rgba(0,176,80,.7)",
			borderWidth: 0,
			categoryPercentage: .9,
			//barPercentage: 1.0
		}]
	},
	options: c_options
});

await delay(1500);
$("#c_kont").siblings("div").remove();
var c_kont = new Chart(document.getElementById("c_kont").getContext("2d"), {
	type: 'bar',
	data: {
		labels: ur_dati2.kont[0],
		datasets: [{
			label: "Tuntas",
			data: ur_dati2.kont[2],
			backgroundColor: 'rgba(0,32,96,.7)',
			borderWidth: 0,
			categoryPercentage: .9,
		},
		{
			label: "Aktif",
			data: ur_dati2.kont[1],
			backgroundColor: "rgba(0,176,80,.7)",
			borderWidth: 0,
			categoryPercentage: .9,
			//barPercentage: 1.0
		}]
	},
	options: c_options
});

$("#TOC").slideDown();
}
</script>
</body>
</html>
