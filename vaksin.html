<!doctype html>
<html lang="id" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="theme-color" content="#343a40">
	<link rel="dns-prefetch" href="https://cdnjs.cloudflare.com/">
	<link rel="icon" href="assets/icon.png" type="image/x-icon">
	<meta name="description" content="Detil informasi penggunaan vaksin di 22 Kab/Kota di NTT. Menyajikan detil perkembangan vaksinasi harian beserta analisis.">
	<meta name="keywords" content="Covid, Corona, Covid NTT, Covid19, Vaksin">
	<meta name="author" content="Jolly Frankle">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="referrer" content="no-referrer-when-downgrade">
	<meta http-equiv='cache-control' content='no-cache'>
	<meta http-equiv='expires' content='0'>
	<meta http-equiv='pragma' content='no-cache'>
	<meta property="og:title" content="JFP: COVID-19 Vaccine Dashboard"/>
	<meta property="og:description" content="Detil informasi penggunaan vaksin di 22 Kab/Kota di NTT. Menyajikan detil perkembangan vaksinasi harian beserta analisis."/>
	<meta property="og:type" content="website"/>
	<meta property="og:image" content="https://jf.jollycomp.com/assets/featured.jpg"/>
	<meta property="og:url" content="https://jollyfrankle.github.io/datakab.html"/>

	<title>JFP: COVID-19 Vaccine Dashboard</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;400;500;700&display=swap" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-167603452-2"></script>
<script>
window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'UA-167603452-2');
</script>
	<style>
body{font-family:"Roboto",sans-serif;}.card{overflow:hidden}.anchor{position:absolute;margin-top:-3.5rem;}.flbet{display:flex;justify-content:space-between;align-items:center}.info-kasus small{display:inline-block;width:80px}#boxVax1, #boxVax2{padding-left:1.25rem;margin-bottom:0;list-style-type:square}.fw-500{font-weight:500}.fs-14{font-size: 14px}.text-teal{color:  #20c997}.diff-ks{white-space: nowrap;}
#TambahanInfo {z-index: 1079; position: sticky; bottom: 0; max-height: 20vh; overflow-y: auto; margin-bottom: 0;}
#MapContainer{height:500px; max-height:75vh; cursor: grab; scrollbar-width: none} #MapContainer:active {cursor: grabbing;}
#MapContainer svg{overflow:auto; width:100%}
#MapContainer svg path:not(.no-select) {cursor: pointer; transition: .5s;}
#MapContainer svg path:not(.no-select):not(.kab_selected):hover {filter: brightness(1.1) contrast(1.1);}
#MapLegend{z-index:1;position:absolute;left:.5rem;bottom:.5rem;width:250px}
#MapNav .dropdown-item { padding: .2rem .75rem; font-size: .875rem; }
#MapNav .dropdown-header { padding: .3rem .75rem }
#MapNav{position:absolute;bottom:.5rem;right:.5rem;width:316px;z-index:0;white-space:nowrap;display:flex}
#MapHeader{position:absolute;top:.5rem;left:.5rem;right:.5rem;margin-bottom:0;z-index: 1;text-align: center;line-height:1.25}
#MapIndLeg{position: absolute;bottom: 3rem;right: .5rem;width:316px;user-select:none}
#MapIndLeg>div {line-height:1;display:flex;justify-content:space-between;position:relative;font-size:80%}
#MapIndLeg>div span:nth-child(2){position:absolute;width:100%;text-align:center}
#MapIndCol{height:.5rem;border-radius:.25rem}
#MapMobileNav{display:none}
.st-btn{display: inline-block!important;}.sharethis-inline-share-buttons{z-index: 1!important}
.btn-share{display: none; width: 40px; height: 40px; border-radius: 20px; font-size: 14px; margin-left: .5rem}
/*.ping-shake{animation:shake .75s cubic-bezier(.36,.07,.19,.97)}
@keyframes shake{10%,90%{transform:translateX(-1px)}20%,80%{transform:translateX(3px)}30%,50%,70%{transform:translateX(-6px)}40%,60%{transform:translateX(6px)}}*/
.chart-container{position:relative; min-width:100%; max-width:100%; margin-bottom:1rem;}
.chart-container div{position:absolute;width:100%;height:100%;text-align:center;display:flex;align-items:center;justify-content:center;background: var(--light)}
.outline-white {text-shadow: -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff, 1px 1px 0 #fff;}
#meta_dist>div {height: 500px; display: flex; flex-direction: column}
#tbl_noupdate td:last-child{text-align: right; white-space: nowrap;} #tbl_noupdate td {vertical-align: top; font-size: 14px}
#tbl_noupdate tr:not(:last-child) {border-bottom: 1px solid #dee2e6 }
@media (max-width: 767.98px) {
	#MapLegend{position:static;border-radius:0;width:calc(100% + 2px);margin:0 -1px;overflow:hidden}
	#MapContainer{max-height:275px;height:50vh}
	#MapIndLeg {position:static;width:calc(100% - 9rem);margin:-1.5rem .5rem .5rem 8.5rem}
	#MapNav{position:static;width:100%;margin: -2.5rem .5rem 1rem}
	#MapMobileNav{display:block;position:absolute;right:.5rem;bottom:126px;width:54px;text-align:right}
	#MapNav .input-group{display: none}
}
#MapContainer::-webkit-scrollbar{display: none;}
@media (max-width:576px) {.chart-container{max-height:45vh;}}

/* Full screen peta */
#peta_supercont.map-fs {position: fixed!important; left: 0; right: 0; top: 0; bottom: 0; width: 100vw; height: 100vh; z-index: 1991}
.map-fs #MapContainer {max-height: 100vh; height: 100vh}
@media (max-width: 767.98px) {
	.map-fs #MapContainer {height: calc(100vh - 93px);}
}
</style>
<noscript><style>body{overflow:hidden;}</style></noscript>
</head>
<body>
	<div style="opacity: 0; position: absolute; z-index: -1; top: 0; max-width: 1px; overflow: hidden"><img src="https://jf.jollycomp.com/assets/featured.jpg" width="1280" height="720"/></div>
	<div class="justify-content-center align-items-center position-fixed" style="width:100vw;height:100vh;background:rgba(0,0,0,.5);top:0;left:0;display:flex;z-index:1080;user-select:none" id="spinner_loader">
		<div class="text-center text-white">
			<div class="spinner-grow text-white" style="width:5rem; height: 5rem" role="status">
				<span class="sr-only">Memuat...</span>
			</div>
			<noscript>
				<h6 class="mb-1 mt-3 px-3">JavaScript Anda tidak aktif</h6>
				<div class="px-3">Halaman ini tidak dapat dimuat tanpa JavaScript</div>
			</noscript>
		</div>
	</div>
	<nav class="navbar navbar-dark shadow bg-dark">
		<div class="container d-md-flex justify-content-between text-center">
			<a class="navbar-brand text-truncate">
				JollyFrankle Projects: COVID-19 NTT Tracker
			</a>
			<div class="d-none d-md-block text-light">
				Data terakhir: <strong class="last_data">Memuat...</strong>
			</div>
		</div>
	</nav>
	<main class="container my-4">
<div class="d-block d-md-flex justify-content-between align-items-center mb-2">
	<div class="text-center text-md-left position-relative">
		<h1>COVID-19 Vaccine Dashboard</h1>
		<p class="mb-2"><span class="fw-500 text-success">Ayo bantu pulihkan negeri!</span> Bersama kita bisa!</p>
	</div>
</div>

<nav class="mb-3 pb-3 border-bottom">
	<div class="d-block d-md-inline-flex btn-group w-100">
		<a class="btn btn-block btn-outline-dark mt-2" href="./">Ringkasan, Grafik, Tabel Pekanan</a>
		<a class="btn btn-block btn-outline-dark">Data hari ini per Kab/Kota</a>
		<a class="btn btn-block btn-outline-dark" href="harian.html">Perkembangan data harian</a>
		<a class="btn btn-block btn-outline-info" href="data-wil.html"><span class="badge badge-info">Prototype</span> Tren kasus per Wilayah</a>
	</div>
	<div class="d-block d-md-inline-flex btn-group w-100">
		<a class="btn btn-block btn-outline-success mt-2 active fw-500"><span class="badge badge-success">BARU</span> Vaksinasi COVID-19 per Wilayah</a>
	</div>
</nav>
<div class="btn-group w-100 mb-2">
	<button class="btn btn-sm btn-outline-danger" data-toggle="collapse" data-target="#ILL_atas" aria-expanded="false" aria-controls="ILL_atas">Disklaimer</button>
	<button class="btn btn-sm btn-outline-info" data-toggle="collapse" data-target="#InfoAtas" aria-expanded="false" aria-controls="InfoAtas">Informasi, daftar isi, halaman lain</button>
</div>
<div class="collapse" id="ILL_atas">
	<div class="alert alert-danger text-justify">
		<strong>DISCLAIMER:</strong> Halaman ini bukan halaman resmi atau halaman yang berafiliasi dengan Dinas Kesehatan Kab/Kota, Dinas Kesehatan Provinsi NTT, Kementerian Kesehatan RI, atau Gugus Tugas Penanganan COVID-19. Data yang disajikan dalam halaman ini murni dari sukarela relawan tanpa campur tangan otoritas manapun.
	</div>
</div>

<div class="card collapse" id="InfoAtas">
	<div class="card-body text-justify">
		<h4 class="border-bottom">Informasi</h4>
		<ul class="pl-4 mb-3">
			<li>Halaman ini memuat perkembangan vaksinasi di Nusa Tenggara timur hari ini dan 3 hari sebelumnya.</li>
		</ul>
		<h4 class="border-bottom">Daftar isi</h4>
		<div class="pl-4 mb-2">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">1.</div>
				<a class="h5 mb-1" href="#Bg1_Peta">Peta Interaktif</a>
			</div>
			Peta interaktif yang menampilkan analisis dan perbandingan data antar-Kabupaten/Kota di Nusa Tenggara Timur.
		</div>
		<div class="pl-4 mb-2">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">2.1</div>
				<a class="h5 mb-1" href="#Bg21_Baru">Penambahan Kasus Baru</a>
			</div>
			Penambahan kasus baru per <span class="tgl_data"></span> di wilayah Nusa Tenggara Timur.
		</div>
		<div class="pl-4 mb-2">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">2.2</div>
				<a class="h5 mb-1" href="#Bg22_Tuntas">Penambahan Kasus Tuntas</a>
			</div>
			Penambahan kasus tuntas (sembuh dan meninggal, tanpa dispesifikasi sembuh atau meninggal) per <span class="tgl_data"></span> di wilayah Nusa Tenggara Timur.
		</div>
		<div class="pl-4 mb-2">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">3.</div>
				<a class="h5 mb-1" href="#Bg3_Grafik">Grafik Perbandingan</a>
			</div>
			Perbandingan kasus aktif dan tuntas dari berbagai wilayah di Nusa Tenggara Timur.
		</div>
		<h4 class="border-bottom">Halaman lain</h4>
		<div class="pl-4 mb-2">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">1.</div>
				<a class="h5 mb-1" href="index.html">Beranda: Analisis dan grafik COVID-19 NTT</a>
			</div>
			Tersedia analisis harian, rekapitulasi data pekanan, dan grafik visualisasi perkembangan kasus COVID-19 Nusa Tenggara Timur.
		</div>
		<div class="pl-4 mb-2">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">2.</div>
				<a class="h5 mb-1" href="datakab.html">Data Per Wilayah</a>
			</div>
			Data perkembangan COVID-19 hari ini dan 2 hari sebelumnya dari 22 Kab/Kota se-Nusa Tenggara Timur.
		</div>
		<div class="pl-4 mb-2">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">3.</div>
				<a class="h5 mb-1" href="harian.html">Perkembangan Kasus</a>
			</div>
			Perkembangan kasus hari-demi-hari di Nusa Tenggara Timur.
		</div>
		<div class="pl-4">
			<div class="d-flex align-items-baseline" style="margin-left:-1.5rem">
				<div style="width:1.5rem">4.</div>
				<a class="h5 mb-1" href="data-wil.html">Tren Kasus per Wilayah</a>
			</div>
			Analisis perkembangan kasus COVID-19 per wilayah: apakah terjadi penurunan kasus dalam 7 hari terakhir, perubahan kasus aktif, serta laju insidensi per satu juta penduduk.
		</div>
	</div>
</div>

<div class="alert alert-danger text-center">
	<strong>PENTING:</strong> Halaman dan konten pada halaman ini <strong>masih dalam tahap pemantauan dan finalisasi</strong>.
</div>

<div class="alert alert-success d-block d-md-flex align-items-center text-justify my-2">
	<div class="text-center mb-4 my-md-0 mt-2">
		<svg xmlns="http://www.w3.org/2000/svg" width="96" height="96" fill="currentColor" viewBox="0 0 16 16"><path d="M4 11a1 1 0 1 1 2 0v1a1 1 0 1 1-2 0v-1zm6-4a1 1 0 1 1 2 0v5a1 1 0 1 1-2 0V7zM7 9a1 1 0 0 1 2 0v3a1 1 0 1 1-2 0V9z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/></svg>
	</div>
	<div class="w-100 ml-0 ml-md-4">
		<h5>Sumber data: Kementerian Kesehatan RI</h5>
		<p class="mb-2">Data yang digunakan pada halaman ini bersumber dari Vaksin Dashboard Kementerian Kesehatan RI, diperbarui setiap hari pada pkl 18.00 WIB (19.00 WITA). Data pada halaman ini akan diperbarui setiap hari antara pkl. 19.00 dan 22.00 WITA.</p>
		<p class="mb-0"><a class="alert-link" href="http://vaksin.kemkes.go.id/">Lihat halaman Vaksin Dashboard Kemkes</a>.</p>
	</div>
</div>

<div class="rounded bg-white shadow overflow-hidden p-3 text-center my-3 d-block d-md-flex align-items-center justify-content-between">
	<div class="mb-2 mb-md-0 fw-500 text-md-left">Tampilkan data untuk tanggal:</div>
	<div id="sel_tgl" class="m-n1 text-md-right"></div>
</div>

<div class="alert alert-info py-2 px-3 d-block text-center d-md-flex justify-content-between align-items-center" style="position:sticky;top:0;z-index:9;">
	<div class="text-md-left">
		<div>Data per tanggal <strong class="tgl_data">Memuat...</strong></div>
	</div>
	<div class="text-md-right">
		<div>Pembaruan <strong class="LastMod">Memuat...</strong></div>
	</div>
</div>

<div id="vaxNTT" class="my-3">
	<div class="text-center mb-3">
		<h6 class="text-center mb-0">NUSA TENGGARA TIMUR</h6>
		<p class="mb-0 small">Data per Kab/Kota terdapat di bagian bawah halaman ini.</p>
	</div>
	<div class="form-row mb-n3">
		<div class="col-lg-4 col-md-6 mb-3">
			<div class="p-3 shadow rounded position-relative overflow-hidden h-100 bg-white" style="border-left: .25rem solid #20c997">
				<h5 class="mb-1 text-teal">Jumlah penerima dosis pertama</h5>
				<div class="display-4 mb-1 flbet">
					<span id="vax1_NTT_sum">• • •</span>
					<i class="fas fa-check small" style="color: #c6c8ca"></i>
				</div>
				<div class="flbet align-items-start">
					<div>
						<div><strong id="vax1_NTT_perc_target">• • •</strong> dari target sasaran</div>
						<div><strong id="vax1_NTT_perc_pend">• • •</strong> dari jlh. penduduk</div>
					</div>
					<div class="text-center">
						<div class="fw-500 diff-ks" id="vax1_NTT_diff"> <i></i> <span></span> </div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-lg-4 col-md-6 mb-3">
			<div class="p-3 shadow rounded position-relative overflow-hidden h-100 bg-white" style="border-left: .25rem solid #007bff">
				<h5 class="mb-1 text-primary">Jumlah penerima dosis kedua</h5>
				<div class="display-4 mb-1 flbet">
					<span id="vax2_NTT_sum">• • •</span>
					<i class="fas fa-check-double small" style="color: #c6c8ca"></i>
				</div>
				<div class="flbet align-items-start">
					<div>
						<div><strong id="vax2_NTT_perc_target">• • •</strong> dari target sasaran</div>
						<div><strong id="vax2_NTT_perc_pend">• • •</strong> dari jlh. penduduk</div>
					</div>
					<div class="text-center">
						<div class="fw-500 diff-ks" id="vax2_NTT_diff"> <i></i> <span></span> </div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-lg-4 mb-3">
			<div class="d-block d-md-flex d-lg-block h-100 flex-row-reverse">
				<div class="rounded shadow -sm d-flex overflow-hidden align-items-center bg-white w-100 box3_1" style="border-left: .25rem solid #17a2b8">
					<div class="px-2 px-sm-3 py-2 w-100 flbet">
						<div>
							<div class="fw-500">Target penerima vaksin</div>
							<div class="lead" style="font-size: 2.5rem; line-height: 1" id="NTT_target">• • •</div>
						</div>
						<i class="h3 mb-0 fas fa-user-tag" style="color: #c6c8ca"></i>
					</div>
				</div>
				<div class="rounded shadow -sm d-flex overflow-hidden align-items-center bg-white w-100 box3_2" style="border-left: .25rem solid #17a2b8">
					<div class="px-2 px-sm-3 py-2 w-100 flbet">
						<div>
							<div class="fw-500">Jumlah penduduk</div>
							<div class="lead" style="font-size: 2.5rem; line-height: 1" id="NTT_pend">• • •</div>
						</div>
						<i class="h3 mb-0 fas fa-users" style="color: #c6c8ca"></i>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div id="Bg1_Peta" class="anchor"></div>
<div id="peta_supercont" data-fs="false" class="bg-white position-relative rounded overflow-hidden shadow mb-3">
	<button type="button" class="map-fs-toggle btn btn-light py-1 px-2" style="position: absolute; right: .5rem; top: .5rem; z-index: 2"><i class="fas fa-expand"></i></button>
	<h6 id="MapHeader" class="outline-white">
		<div id="MapTitle">Memuat Peta...</div>
		<div class="small text-muted">Perhatikan skala di bawah peta untuk konteks</div>
	</h6>
	<div id="MapContainer" class="user-select-none" style="background:#C6ECFF" data-zoom-on-wheel="zoom-amount: 0.002; min-scale: 1; max-scale: 5;" data-pan-on-drag >
	</div>
	<div id="MapIndLeg">
		<div>
			<span>0</span><span>50</span><span>100</span>
		</div>
		<div id="MapIndCol"></div>
	</div>
	<div id="MapMobileNav">
		<div class="btn-group-vertical mb-1">
			<button class="btn btn-sm btn-secondary map-zoom w-100" data-zoom="in">+</button>
			<button class="btn btn-sm btn-secondary map-zoom w-100" data-zoom="out">–</button>
		</div>
		<button class="btn btn-sm btn-secondary" type="button" onclick="svgPanZoomContainer.resetScale(document.getElementById('MapContainer'))">Reset</button>
	</div>
	<div id="MapNav">
		<div class="btn-group dropup">
			<button type="button" class="btn btn-dark btn-sm dropdown-toggle mr-2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Tampilan Data</button>
			<div class="dropdown-menu">
				<h6 class="dropdown-header flbet">Statistik Dosis 1<i class="small fas fa-check"></i></h6>
				<button class="dropdown-item" data-mapdata="1">Penambahan hari ini</button>
				<button class="dropdown-item" data-mapdata="2">Persen dari target</button>
				<div class="dropdown-divider my-1"></div>
				<h6 class="dropdown-header flbet">Statistik Dosis 2<i class="small fas fa-check-double"></i></h6>
				<button class="dropdown-item" data-mapdata="3">Penambahan hari ini</button>
				<button class="dropdown-item" data-mapdata="4">Persen dari target</button>
			</div>
		</div>
		<div class="input-group-sm input-group">
			<div class="btn-group input-group-prepend">
				<button class="btn btn-sm btn-secondary map-zoom px-2" data-zoom="in">+</button>
				<button class="btn btn-sm btn-secondary map-zoom px-2" data-zoom="out">–</button>
			</div>
			<input type="number" class="form-control" id="MapScale" value="100" min="100" step="1.00" max="" oninput="window.inputting=true;svgPanZoomContainer.setScale(document.getElementById('MapContainer'),+this.value/100)"/>
			<div class="input-group-append">
				<button class="btn btn-sm btn-secondary" type="button" onclick="svgPanZoomContainer.resetScale(document.getElementById('MapContainer'))">Reset</button>
			</div>
		</div>
	</div>
	<div id="MapLegend" class="shadow bg-white rounded overflow-hidden">
		<div class="p-2 border-bottom">
			<div class="small">Anda memilih:</div>
			<div id="ml_kab" class="h6 mb-0 text-truncate">Belum ada Kab/Kota. Klik peta.</div>
		</div>
		<a class="d-flex justify-content-between small align-items-center px-2 py-1 bg-light" style="text-decoration: none" href="#Bg4_Kasus" id="ml_anchor" data-kab="-1">Lihat statistik lengkap <i class="fas fa-arrow-right"></i></a>
	</div>
</div>

<div class="p-2 m-n2">
<div class="row">
	<div class="col-md-6 mb-3">
		<div class="anchor" id="Bg21_Baru"></div>
		<div class="overflow-hidden rounded shadow h-100">
			<div class="pb-1" style="background:#20c997"></div>
			<div class="card-body">
				<h5 class="card-title mb-1">Penambahan penyuntikan dosis 1</h5>
				<p class="mb-1 text-muted">Penyuntikan dosis pertama pada <span class="tgl_data">Memuat...</span>.</p>
				<hr class="my-2"/>
				<div class="font-weight-bold flbet" style="color:#20c997">Nusa Tenggara Timur <span id="vax1incNTT"></span></div>
				<ul id="boxVax1"><div class="bg-light rounded py-4 px-3 text-center">Memuat...</div></ul>
			</div>
		</div>
	</div>
	<div class="col-md-6 mb-3">
		<div class="anchor" id="Bg22_Tuntas"></div>
		<div class="overflow-hidden rounded shadow h-100">
			<div class="pb-1" style="background:#007bff"></div>
			<div class="card-body">
				<h5 class="card-title mb-1">Penambahan penyuntikan dosis 2</h5>
				<p class="mb-1 text-muted">Penyuntikan dosis pertama pada per <span class="tgl_data">Memuat...</span>.</p>
				<hr class="my-2"/>
				<div class="font-weight-bold flbet" style="color:#007bff">Nusa Tenggara Timur <span id="vax2incNTT"></span></div>
				<ul id="boxVax2"><div class="bg-light rounded py-4 px-3 text-center">Memuat...</div></ul>
			</div>
		</div>
	</div>
</div>
<div class="small text-muted text-center">Sumber data pada halaman ini adalah tunggal. Data rilis Satgas Kab/Kota tidak digunakan.</div>

	<div class="border-top mt-2 px-2 py-1 small mx-n2 mb-n2 bg-dark text-light" id="ffss_footer" style="display: none">
		<div class="d-flex align-items-center justify-content-between">
			<strong><i class="fas fa-globe"></i> jollyfrankle.github.io</strong>
			<span><i class="fab fa-twitter"></i> <i class="fab fa-github"></i> @JollyFrankle</span>
		</div>
	</div>
</div>

<div class="border-top border-bottom my-3 py-2 fs-14 text-center"> <!-- Placeholder for share buttons -->
	<div class="mb-1">Bagikan informasi ini</div>
	<div class="d-flex user-select-none justify-content-center">
		<div class="sharethis-inline-share-buttons"></div>
		<button class="btn btn-share btn-primary"><i class="fas fa-share-alt"></i></button>
	</div>
</div>

<div id="Bg3_Grafik" class="anchor"></div>
<h4 class="text-center mb-1">Penyuntikan Dosis 1 dan 2 Relatif Target Wilayah</h4>
<p class="text-center text-muted mb-0">Klik pada teks legenda (di atas grafik, di bawah tulisan ini) untuk menyaring data yang tampil.</p>
<div class="chart-container mb-0" style="height:500px;width:600px;">
	<div class="rounded">Memuat grafik...</div>
	<canvas id="c_vax12"></canvas>
</div>

<div id="Bg4_Kasus" class="anchor"></div>
<div class="mt-3 p-3 p-md-4 rounded mb-4 shadow d-block d-sm-flex align-items-center justify-content-between bg-white">
	<div class="text-center text-sm-left">
		<div class="display-2 text-secondary d-block d-sm-none mb-3"><i class="fas fa-map-marked-alt"></i></div>
		<h2 class="display-4 mb-3" style="font-size: 2.65rem">Rincian wilayah</h2>
		<div class="input-group mx-auto mx-sm-0" style="max-width: 400px">
			<select class="custom-select" id="selDati2">
				<option value="" selected disabled>Pilih Kab/Kota...</option>
			</select>
			<div class="input-group-append">
				<button id="selDati2_show" class="btn btn-dark">Tampilkan</button>
			</div>
		</div>
	</div>
	<div class="d-none d-sm-block overflow-hidden my-n3 my-md-n4 mr-n3 mr-md-n4 position-relative" style="line-height: 0">
		<div class="my-n3" style="transform: rotate(-5deg); font-size: 17rem; color: #c6c8ca"><i class="fas fa-syringe"></i></div>
	</div>
</div>
<section id="iD2_wrapper" class="shadow bg-white rounded position-relative overflow-hidden" style="display: none">
<div class="position-absolute bg-light align-items-center justify-content-center text-secondary" id="iD2_loader" style="z-index: 1078; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; display: flex">
	<div class="spinner-border" role="status">
		<span class="sr-only">Memuat...</span>
	</div>
</div>
<div class="p-3 position-relative overflow-hidden">
	<div style="position: absolute; top: 1rem; right: 1rem; opacity: .5; pointer-events: none; user-select: none;">
		<img id="iD2_logo" style="width: 200px; max-width: 40vw" />
	</div>
	<div style="position: absolute; bottom: -2rem; right: -1rem; font-size: 8rem; line-height: 0; color: #c6c8ca">
		<i class="fas fa-shield-virus"></i>
	</div>
	<div class="small text-muted fw-500 outline-white position-relative">MENAMPILKAN STATISTIK UNTUK</div>
	<h4 id="iD2_kab" class="position-relative outline-white">&ndash;</h4>
	<div class="form-row mb-n3">
		<div class="col-lg-4 col-md-6 mb-3">
			<div class="p-3 shadow rounded position-relative overflow-hidden h-100 bg-white" style="border-left: .25rem solid #20c997">
				<h6 class="mb-1">Jumlah penerima dosis pertama</h6>
				<div class="display-4 mb-1 flbet">
					<span id="iD2_vax1_sum">&ndash;</span>
					<i class="fas fa-check small" style="color: #c6c8ca"></i>
				</div>
				<div class="flbet">
					<div>
						<div><strong id="iD2_vax1_perc_target">&ndash;</strong> dari target sasaran</div>
						<div><strong id="iD2_vax1_perc_pend">&ndash;</strong> dari jlh. penduduk</div>
					</div>
					<div class="text-center">
						<div class="fw-500 diff-ks" id="iD2_vax1_diff"> <i></i> <span></span> </div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-lg-4 col-md-6 mb-3">
			<div class="p-3 shadow rounded position-relative overflow-hidden h-100 bg-white" style="border-left: .25rem solid #007bff">
				<h6 class="mb-1">Jumlah penerima dosis kedua</h6>
				<div class="display-4 mb-1 flbet">
					<span id="iD2_vax2_sum">&ndash;</span>
					<i class="fas fa-check-double small" style="color: #c6c8ca"></i>
				</div>
				<div class="flbet">
					<div>
						<div><strong id="iD2_vax2_perc_target">&ndash;</strong> dari target sasaran</div>
						<div><strong id="iD2_vax2_perc_pend">&ndash;</strong> dari jlh. penduduk</div>
					</div>
					<div class="text-center">
						<div class="fw-500 diff-ks" id="iD2_vax2_diff"> <i></i> <span></span> </div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-lg-4 mb-3" id="iD2_col3">
			<div class="d-block d-md-flex d-lg-block h-100 flex-row-reverse">
<style>
.box3_1 {height: calc(50% - .5rem); margin-bottom: 1rem}
.box3_2 {height: calc(50% - .5rem)}
@media (min-width: 768px) and (max-width: 991.98px) {
	.box3_1 {height: 100%; margin-bottom: 0}
	.box3_2 {height: 100%; margin-right: .75rem}
}
</style>
				<div class="rounded shadow -sm d-flex overflow-hidden align-items-center bg-white w-100 box3_1" style="border-left: .25rem solid #17a2b8">
					<div class="px-2 px-sm-3 py-2 w-100 flbet">
						<div>
							<div class="fw-500">Target penerima vaksin</div>
								<!--<div class="lead" style="font-size: 2.5rem; line-height: 1" id="iD2_box3num">& ndash;</div>-->
							<div class="lead" style="font-size: 2.5rem; line-height: 1" id="iD2_target">–</div>
						</div>
						<i class="h3 mb-0 fas fa-user-tag" style="color: #c6c8ca"></i>
					</div>
				</div>
				<div class="rounded shadow -sm d-flex overflow-hidden align-items-center bg-white w-100 box3_2" style="border-left: .25rem solid #17a2b8">
					<div class="px-2 px-sm-3 py-2 w-100 flbet">
						<div>
							<div class="fw-500">Jumlah penduduk</div>
							<!--<div class="lead" style="font-size: 2.5rem; line-height: 1" id="iD2_box3num">& ndash;</div>-->
							<div class="lead" style="font-size: 2.5rem; line-height: 1" id="iD2_pend">–</div>
						</div>
						<i class="h3 mb-0 fas fa-users" style="color: #c6c8ca"></i>
					</div>
				</div>
			</div>
		</div>
	</div>
	<h6 class="my-3 text-center">PENERIMA VAKSIN BERDASARKAN BATCH</h6>
<style>
.list-batch {
	margin: 0;
	padding: 0;
	list-style-type: none;
}
.list-column li {
	break-inside: avoid
}
.list-batch li:not(:last-child) {
	margin-bottom: .75rem;
}
.list-batch li .icon {
	width: 2.5rem;
	max-width: 2.5rem;
	min-width: 2.5rem;
	margin-left: .5rem;
	font-size: 1.75rem;
	line-height: 1;
	text-align: center;
	color: #c6c8ca;
}
</style>
	<div class="form-row mb-n3">
		<div class="col-lg-4 col-md-6 mb-3">
			<div class="rounded overflow-hidden bg-white shadow card-body h-100" style="border-top: .25rem solid #20c997;">
				<h6 class="flbet">Dosis pertama <i class="fas fa-check"></i></h6>
				<hr/>
				<p class="text-justify">Persentase yang ditampilkan di sebelah kanan batch relatif terhadap target sasaran.</p>
				<ul class="list-batch" id="iD2_batchVax1"></ul>
			</div>
		</div>
		<div class="col-lg-4 col-md-6 mb-3">
			<div class="rounded overflow-hidden bg-white shadow card-body h-100" style="border-top: .25rem solid #007bff;">
				<h6 class="flbet">Dosis kedua <i class="fas fa-check-double"></i></h6>
				<hr/>
				<p class="text-justify">Persentase yang ditampilkan di sebelah kanan batch relatif terhadap target sasaran.</p>
				<ul class="list-batch" id="iD2_batchVax2"></ul>
			</div>
		</div>
		<div class="col-lg-4 mb-3">
			<div class="rounded overflow-hidden bg-white shadow card-body h-100" style="border-top: .25rem solid #17a2b8;">
				<h6 class="flbet">Target sasaran <i class="fas fa-user-tag"></i></h6>
				<hr/>
				<p class="text-justify">Vaksinasi Gotong–Royong tidak memiliki / mencantumkan target sasaran.</p>
				<ul class="list-batch list-column" style="column-width: 250px; column-gap: 2.5rem;" id="iD2_batchTarget"></ul>
			</div>
		</div>
	</div>
	<h6 class="my-3 text-center">ANALISIS LANJUTAN</h6>
	<div class="form-row mb-n3">
		<div class="col-lg-4 col-md-6 mb-3">
			<div class="rounded overflow-hidden bg-white shadow card-body h-100 text-center" style="border-top: .25rem solid #fd7e14;">
				<div class="display-4 mb-2" id="iD2_al1_num">&ndash;</div>
				<h6>Persentase penerima vaksin 1 yang telah menerima vaksin 2</h6>
				<p class="mb-0">Secara kasar, <span id="iD2_al1_tx1"></span> dari 100 penerima vaksin pertama telah menerima juga suntikan kedua.</p>
			</div>
		</div>
		<div class="col-lg-4 col-md-6 mb-3">
			<div class="rounded overflow-hidden bg-white shadow card-body h-100 text-center" style="border-top: .25rem solid #fd7e14;">
				<div class="display-4 mb-2" id="iD2_al2_num">&ndash;</div>
				<h6>Persentase populasi yang telah divaksinasi penuh</h6>
				<p class="mb-0">Guna mencapai treshold "<em>herd immunity"</em> (70%), dibutuhkan <span id="iD2_al2_tx1"></span> orang lagi yang mendapat vaksinasi lengkap.</p>
			</div>
		</div>
		<div class="col-lg-4 col-md-6 mb-3">
			<div class="rounded overflow-hidden bg-white shadow card-body h-100 text-center" style="border-top: .25rem solid #fd7e14;">
				<div class="display-4 mb-2" id="iD2_al3_num">&ndash;</div>
				<h6>Jumlah vaksin yang telah disuntikkan (dosis 1 & 2)</h6>
				<p class="mb-0">Dari jumlah ini, sebanyak <span id="iD2_al3_tx1"></span> (<span id="iD2_al3_tx2"></span>) telah diberikan sebagai dosis pertama dan <span id="iD2_al3_tx3"></span> (<span id="iD2_al3_tx4"></span>) telah diberikan sebagai dosis kedua.</p>
			</div>
		</div>
		<div class="col-lg-4 col-md-6 mb-3">
			<div class="rounded overflow-hidden bg-white shadow card-body h-100 text-center" style="border-top: .25rem solid #fd7e14;">
				<div class="display-4 mb-2" id="iD2_al4_num">&ndash;</div>
				<h6>Sumbangan kab/kota terhadap progress vaksin 1 Provinsi NTT</h6>
				<p class="mb-0">Seberapa banyak dari jumlah vaksinasi pertama yang telah diberikan di Provinsi NTT disumbangkan oleh kab/kota ini.</p>
			</div>
		</div>
		<div class="col-lg-4 col-md-6 mb-3 d-none d-md-block">
			<div class="d-flex align-items-center justify-content-center h-100 w-100">
				<div class="text-center">
					<img src="assets/icon.png" width="72" class="mb-2"/>
					<div class="fw-500">JOLLYFRANKLE.GITHUB.IO</div>
				</div>
			</div>
		</div>
		<div class="col-lg-4 col-md-6 mb-3">
			<div class="rounded overflow-hidden bg-white shadow card-body h-100 text-center" style="border-top: .25rem solid #fd7e14;">
				<div class="display-4 mb-2" id="iD2_al5_num">&ndash;</div>
				<h6>Sumbangan kab/kota terhadap progress vaksin 2 Provinsi NTT</h6>
				<p class="mb-0">Seberapa banyak dari jumlah vaksinasi kedua yang telah diberikan di Provinsi NTT disumbangkan oleh kab/kota ini.</p>
			</div>
		</div>
	</div>
	<div class="position-relative outline-white text-muted font-italic mt-3">
		Data hanya bersumber dari Dashboard Vaksin Kemkes. Data yang dirilis Satgas Kabupaten mungkin berbeda.
	</div>
</div>
</section>

<div id="TambahanInfo" class="alert mt-4"><h6 class="mb-1" id="TI_header"></h6><p class="mb-0 small" id="TI_text"></p></div>

<template id="tmpBatch">
	<li>
		<div class="flbet align-items-end mb-1"><span class="fw-500">{nama}</span> <span class="small fw-500">{perc}</span></div>
		<div class="flbet">
			<div class="flbet w-100 align-items-end" style="width: calc(100% - 3rem);">
				<div class="lead" style="font-size: 2.5rem; line-height: 1">{jumlah}</div>
				<div class="fw-500 {ind_color}"> <i class="{ind_class}"></i> <span>{ind_text}</span> </div>
				<!--<div class="fw-500 text-success"> <i class="fas fa-globe"></i> <span>500</span> </div>-->
			</div>
			<div class="icon"><i class="{icon}"></i></div>
		</div>
	</li>
</template>

</main>
<footer class="bg-dark text-light">
	<div class="container p-3">
		<strong>Jolly Frankle @ GitHub</strong>
		<div class="small">Kontak: jollyfrankle3@gmail.com</div>
	</div>
</footer>
<style id="map_style"></style><style id="activewil"></style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/svg-pan-zoom-container@0.5.0"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.4.1/chart.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.0.0/chartjs-plugin-datalabels.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
<script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=610360f35e77f700194656e8&product=inline-share-buttons' async='async'></script>
<script>
const delay = ms => new Promise(res=>setTimeout(res,ms));
const NamaBulan = ["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];
const NamaHari = ["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];
const numFormat = new Intl.NumberFormat('id-ID', {maximumFractionDigits: 2});

var url = new URL(window.location.href);
var tgl = url.searchParams.get("tgl");
val_tgl = moment(tgl, 'YYYY-MM-DD', true).isValid();
tgl_c = (val_tgl && moment(tgl).isSameOrAfter('2021-07-17')) ? tgl : null;

if(navigator.share) {
	$(".btn-share").fadeIn();
}
$(".btn-share").on("click", function() {
	navigator.share({
		title: $("head>title").text(),
		url: window.location.href
	}).then(() => {
		console.log('Share completed');
	})
	.catch(console.error);
});

function NolAwal(num, padlen) {
	var pad_char = '0';
	var pad = new Array(1 + padlen).join(pad_char);
	return (pad + num).slice(-pad.length);
}
function DateIndo(d,mode) {var t=new Date(d);var o="";o=mode==2?NamaHari[t.getDay()]+", " : ""; o+=t.getDate()+" "+NamaBulan[t.getMonth()]+" "+t.getFullYear(); return o;}
function dateIND_short(d) {var t=new Date(d);return NolAwal(t.getDate(), 2)+"-"+NolAwal(t.getMonth()+1,2)+"-"+t.getFullYear();}
$.ajax({
	url: "peta-ntt.svg",
	dataType: 'html',
	success: function(data){
		$("#MapContainer").prepend(data);
		$("#MapContainer svg path:not(.no-select)").prop("tabindex",0).prop("title", "AAA").data("toggle", "popover").data("trigger", "focus").tooltip();

		var MapCon=document.getElementById('MapContainer');
		$(".map-zoom").on("click",function() {
			scale = svgPanZoomContainer.getScale(MapCon);
			if($(this).data("zoom")=="in")
				svgPanZoomContainer.setScale(MapCon, scale+(0.15*scale));
			if($(this).data("zoom")=="out")
				svgPanZoomContainer.setScale(MapCon, scale-(0.15*scale));
		});
new MutationObserver(function (mutations) {
	if (window.inputting) {
	delete window.inputting
	} else {
	mutations.forEach(function (mutation) {
		document.getElementById('MapScale').value = (Math.round(svgPanZoomContainer.getScale(mutation.target.parentElement) * 10000) / 100).toFixed(2)
	});
	}
}).observe(document.getElementById('MapContainer').firstElementChild, {
	attributes: true,
	attributeFilter: ['transform'],
});
const observer = new MutationObserver(function (mutations) {
	mutations.forEach(function (mutation) {
	console.log('scale: ', mutation.target.dataset.scale)
	});
});

observer.observe(document.getElementById('MapContainer'), {
	attributes: true,
	attributeFilter: ['data-scale'],
});

	}
});

if(url.searchParams.get("ffss")=="true") {
	$("#ffss_footer").show();
	$("#TambahanInfo").remove();
}

$.ajax({
	url:'https://jf.jollycomp.com/ajax/public.php',
	data: {action: "vaksin", tgl: tgl_c},
	method: "POST",
	dataType: "json",
	timeout: 5000,
	success: function(data){
		if(data.success) {
			var t = new Date(data.last_update);
			$(".LastMod").text(DateIndo(t)+", "+NolAwal(t.getHours(),2)+"."+NolAwal(t.getMinutes(),2)+"."+NolAwal(t.getSeconds(),2)+" WITA");
			$(".tgl_data").text(DateIndo(data.tgl_data));
			$(".last_data").text(DateIndo(data.last_data));
			$.each(data.tgl_ok, function(k,v) {
				$("#sel_tgl").prepend('<a href="datakab.html?tgl='+v+'" class="btn btn-outline-primary m-1 '+(data.tgl_data==v ? "active" : "")+'">'+DateIndo(v)+'</a>');
			});
			//$("#spinner_loader").fadeOut(); // Pindah ke: SHORT__SPINNER_PETA
			AJAX_Complete(data);
			if(data.peng.show) {
				$("#TI_header").html(data.peng.header);
				$("#TI_text").html(data.peng.text);
				$("#TambahanInfo").addClass("alert-"+(data.peng.type ?? "info")).show();
			}
		}
		if(data.error) alert("[!] Data tidak dapat diambil:\n\nAlasan: "+data.text+"\n\nHubungi jollyfrankle3@gmail.com apabila Anda yakin ini kesalahan.");
	},
	error: function(data) {
		$("#spinner_loader>div").append('<h6 class="mt-3 mb-1">Data tidak dapat diambil.</h6><div class="small mb-2">Anda dapat mencoba memuat ulang halaman ini.</div><a href="javascript:location.reload()" class="btn btn-sm btn-light fw-500" draggable="false">Muat ulang</a>');
	}
});

async function AJAX_Complete(data){
function indSelKs(x,y,mode)
{
	var status=false, num=x-y, icon="fas fa-minus", color="muted";
	if(num!= 0 && !isNaN(num)) status = true;
	if(num < 0) icon = "fas fa-angle-double-down";
	if(num > 0) icon = "fas fa-angle-double-up";

	if(mode==1) {
		if(num > 0.001*x) color="success";
	}
	if(mode==2) {
		if(num > 0.001*x) color="success";
	}
	return [status, Math.abs(num), icon, color];
}
function compare(a,b) {
	if (a[0] > b[0]) return -1;
	if (a[0] < b[0]) return 1;
	return 0;
}
function getMinMax(arr) {
	let min = arr[0];
	let max = arr[0];
	let i = arr.length;
	while (i--) {
		min = arr[i] < min ? arr[i] : min;
		max = arr[i] > max ? arr[i] : max;
	}
	return { min, max };
}
function rgba2rgb(background, color) {
	const alpha = color[3];
	return "rgba("+Math.floor((1 - alpha) * background[0] + alpha * color[0] + 0.5)+","+
	Math.floor((1 - alpha) * background[1] + alpha * color[1] + 0.5)+","+
	Math.floor((1 - alpha) * background[2] + alpha * color[2] + 0.5)+")";
}

var arrVax1inc=[], arrVax2inc=[], arrNoChange=[], H_Vax1inc=0, H_Vax2inc=0, H_AktfJlh=0, preFiltered={"vax":[]}, list_kab=[], totalVax1=0, totalVax2=0, total = {vax: [0, 0], pend: 0, target: 0}, H_vax1rate=0, H_vax2rate=0, tot_perc=[0,0];
$.each(data.dt_kab, function(k,v) {
	$("#selDati2").append('<option value="'+k+'">'+v.nama+'</option>');
	list_kab.push(v.nama);
	var newVax1=v.vaksin1.tot[0]-v.vaksin1.tot[1], newVax2=v.vaksin2.tot[0]-v.vaksin2.tot[1];
	totalVax1+=newVax1;
	totalVax2+=newVax2;
	total.vax[0]+=v.vaksin1.tot[0]; // Jlh vaksin 1
	total.vax[1]+=v.vaksin2.tot[0]; // Jlh vaksin 2
	total.pend+=v.pend;
	total.target+=v.target.total;

	if(newVax1) arrVax1inc.push([newVax1,v.nama]);
	if(newVax2) arrVax2inc.push([newVax2,v.nama]);
	
	if(v.tgl!=data.tgl_data) $("#tbl_noupdate tbody").append('<tr><td>'+v.nama+'</td><td>'+dateIND_short(v.tgl)+'</td></tr>');

	preFiltered["vax"].push([v.vaksin1.tot[0]+v.vaksin2.tot[0], v.vaksin1.tot[0], v.vaksin2.tot[0], v.target.total, v.nama]);

	percVax1 = v.vaksin1.tot[0] / v.target.total;
	percVax2 = v.vaksin2.tot[0] / v.target.total;

	H_Vax1inc = newVax1 < H_Vax1inc ? H_Vax1inc : newVax1;
	H_Vax2inc = newVax2 < H_Vax2inc ? H_Vax2inc : newVax2;
	H_vax1rate = percVax1 < H_vax1rate ? H_vax1rate : percVax1;
	H_vax2rate = percVax2 < H_vax2rate ? H_vax2rate : percVax2;

	tot_perc[0]+=percVax1; tot_perc[1]+=percVax2;
	//H_KonfJlh = v.konf.tot[0] < H_KonfJlh ? H_KonfJlh : v.konf.tot[0];
	//H_PerAkt = (ks_aktif/v.konf.tot[0]) < H_PerAkt ? H_PerAkt : (ks_aktif/v.konf.tot[0]);
	//H_AktfJlh = ks_aktif < H_AktfJlh ? H_AktfJlh : ks_aktif;
});

$("#vax1_NTT_sum").text(numFormat.format(total.vax[0]));
$("#vax2_NTT_sum").text(numFormat.format(total.vax[1]));
$("#vax1_NTT_perc_target").text(numFormat.format(total.vax[0]*100/total.target)+"%");
$("#vax2_NTT_perc_target").text(numFormat.format(total.vax[1]*100/total.target)+"%");
$("#vax1_NTT_perc_pend").text(numFormat.format(total.vax[0]*100/total.pend)+"%");
$("#vax2_NTT_perc_pend").text(numFormat.format(total.vax[1]*100/total.pend)+"%");
var ind = indSelKs(total.vax[0], total.vax[0]-totalVax1, 1);
if(ind[0]==true) {
	$("#vax1_NTT_diff").addClass("text-"+ind[3]);
	$("#vax1_NTT_diff>i").addClass(ind[2]); $("#vax1_NTT_diff>span").text(numFormat.format(ind[1]));
}
var ind = indSelKs(total.vax[1], total.vax[1]-totalVax2, 1);
if(ind[0]==true) {
	$("#vax2_NTT_diff").addClass("text-"+ind[3]);
	$("#vax2_NTT_diff>i").addClass(ind[2]); $("#vax2_NTT_diff>span").text(numFormat.format(ind[1]));
}

$("#NTT_target").text(numFormat.format(total.target));
$("#NTT_pend").text(numFormat.format(total.pend));

$("#vax1incNTT").text("+"+numFormat.format(totalVax1)+" dosis");
$("#vax2incNTT").text("+"+numFormat.format(totalVax2)+" dosis");

arrVax1inc.sort(compare); arrVax2inc.sort(compare);
$("#boxVax1, #boxVax2").html("");
if(arrVax1inc.length==0) $("#boxVax1").append('<div class="bg-light rounded py-4 px-3 text-center">Tidak ada update</div>');
else $.each(arrVax1inc,function(key,val) {
	val0 = val[0] < 0 ? numFormat.format(val[0]) : "+"+numFormat.format(val[0]);
	$("#boxVax1").append("<li><div class='flbet'>"+val[1]+"<strong>"+val0+"</strong></div></li>");
});

if(arrVax2inc.length==0) $("#boxVax2").append('<div class="bg-light rounded py-4 px-3 text-center">Tidak ada update</div>');
else $.each(arrVax2inc,function(key,val) {
	val0 = val[0] < 0 ? numFormat.format(val[0]) : "+"+numFormat.format(val[0]);
	$("#boxVax2").append("<li><div class='flbet'>"+val[1]+"<strong>"+val0+"</strong></div></li>");
});

$("#selDati2_show").on("click", function(){
	var kab_id = $("#selDati2").val();
	//console.log(kab_id);
	if(kab_id=="" || kab_id===null || kab_id<0 || kab_id>21) {
		$("#iD2_wrapper").slideUp();
		return false;
	}
	const dt=data.dt_kab[kab_id], dt_ntt=data.ntt;
	// Inisialisasi
	$("#iD2_kab").text(dt.nama);
	$(".diff-ks").removeClass("text-danger text-success text-muted");
	$(".diff-ks>i").prop("class", "");
	$(".diff-ks>span").text("");
	$("#iD2_loader").show();
	$("#iD2_logo").prop("src", "https://upload.wikimedia.org/wikipedia/commons/thumb/"+dt.logo);
	$("#iD2_logo").on("load", function(){$("#iD2_loader").fadeOut(); $("#iD2_logo").css("display", "block")});
	$("#iD2_logo").on("error", function(){$("#iD2_loader").fadeOut(); $("#iD2_logo").css("display", "none")});
	$("#iD2_batchVax1, #iD2_batchVax2, #iD2_batchTarget").html("");


	$("#iD2_vax1_sum").text(numFormat.format(dt.vaksin1.tot[0]));
	$("#iD2_vax1_perc_target").text(numFormat.format(dt.vaksin1.tot[0]*100/dt.target.total)+"%");
	$("#iD2_vax1_perc_pend").text(numFormat.format(dt.vaksin1.tot[0]*100/dt.pend)+"%");
	var ind = indSelKs(dt.vaksin1.tot[0], dt.vaksin1.tot[1], 1);
	if(ind[0]==true) {
		$("#iD2_vax1_diff").addClass("text-"+ind[3]);
		$("#iD2_vax1_diff>i").addClass(ind[2]); $("#iD2_vax1_diff>span").text(numFormat.format(ind[1]));
	}

	$("#iD2_vax2_sum").text(numFormat.format(dt.vaksin2.tot[0]));
	$("#iD2_vax2_perc_target").text(numFormat.format(dt.vaksin2.tot[0]*100/dt.target.total)+"%");
	$("#iD2_vax2_perc_pend").text(numFormat.format(dt.vaksin2.tot[0]*100/dt.pend)+"%");
	var ind = indSelKs(dt.vaksin2.tot[0], dt.vaksin2.tot[1], 1);
	if(ind[0]==true) {
		$("#iD2_vax2_diff").addClass("text-"+ind[3]);
		$("#iD2_vax2_diff>i").addClass(ind[2]); $("#iD2_vax2_diff>span").text(numFormat.format(ind[1]));
	}

	$("#iD2_target").text(numFormat.format(dt.target.total));
	$("#iD2_pend").text(numFormat.format(dt.pend));

	// Batch penyuntikan vaksin + target per batch
	$.each(dt.vaksin1.kat[0], function(k,v) {
		//console.log(k,v,data.batch);
		var tmp = $("#tmpBatch").html();
		tmp = tmp.replace("{icon}", data.batch[k][1]).replace("{nama}", data.batch[k][0]).replace("{jumlah}", numFormat.format(v));
		if(k in dt.target.batch) tmp = tmp.replace("{perc}", numFormat.format((v*100/dt.target.batch[k]))+"%");
		else tmp = tmp.replace("{perc}", "");
		if(dt.vaksin1.kat[1]!==null && k in dt.vaksin1.kat[1]) {
			var ind = indSelKs(v, dt.vaksin1.kat[1][k], 1);
			if(ind[0]==true) {
				tmp = tmp.replace("{ind_color}", "text-"+ind[3])
				.replace("{ind_class}", ind[2])
				.replace("{ind_text}", numFormat.format(ind[1]));
			} else tmp = tmp.replace("{ind_color}", "").replace("{ind_class}", "").replace("{ind_text}", "");
		} else tmp = tmp.replace("{ind_color}", "").replace("{ind_class}", "").replace("{ind_text}", "");
		$("#iD2_batchVax1").append(tmp);
	});

	$.each(dt.vaksin2.kat[0], function(k,v) {
		var tmp = $("#tmpBatch").html();
		tmp = tmp.replace("{icon}", data.batch[k][1]).replace("{nama}", data.batch[k][0]).replace("{jumlah}", numFormat.format(v));
		if(k in dt.target.batch) tmp = tmp.replace("{perc}", numFormat.format((v*100/dt.target.batch[k]))+"%");
		else tmp = tmp.replace("{perc}", "");
		if(dt.vaksin1.kat[1]!==null && k in dt.vaksin1.kat[1]) {
			var ind = indSelKs(v, dt.vaksin2.kat[1][k], 1);
			if(ind[0]==true) {
				tmp = tmp.replace("{ind_color}", "text-"+ind[3])
				.replace("{ind_class}", ind[2])
				.replace("{ind_text}", numFormat.format(ind[1]));
			} else tmp = tmp.replace("{ind_color}", "").replace("{ind_class}", "").replace("{ind_text}", "");
		} else tmp = tmp.replace("{ind_color}", "").replace("{ind_class}", "").replace("{ind_text}", "");
		$("#iD2_batchVax2").append(tmp);
	});

	$.each(dt.target.batch, function(k,v) {
		var tmp = $("#tmpBatch").html();
		tmp = tmp.replace("{icon}", data.batch[k][1]).replace("{nama}", data.batch[k][0]).replace("{jumlah}", numFormat.format(v)).replace("{perc}", "");
		tmp = tmp.replace("{ind_color}", "").replace("{ind_class}", "").replace("{ind_text}", "");
		$("#iD2_batchTarget").append(tmp);
	});

	// Analisis Lanjutan
	$("#iD2_al1_num").text(numFormat.format(dt.vaksin2.tot[0]*100/dt.vaksin1.tot[0])+"%");
	$("#iD2_al1_tx1").text(numFormat.format((dt.vaksin2.tot[0]*100/dt.vaksin1.tot[0]).toFixed(0)));

	var percV2now = dt.vaksin2.tot[0]/dt.pend;
	$("#iD2_al2_num").text(numFormat.format(percV2now*100)+"%");
	if(percV2now < 0.7) // Herd immunity = 70% populasi
		$("#iD2_al2_tx1").text("dibutuhkan "+numFormat.format(((0.7-percV2now)*dt.pend).toFixed(0)));
	else $("#iD2_al2_tx1").text(0);

	$("#iD2_al3_num").text(numFormat.format(dt.vaksin1.tot[0]+dt.vaksin2.tot[0]));
	$("#iD2_al3_tx1").text(numFormat.format(dt.vaksin1.tot[0]));
	$("#iD2_al3_tx2").text(numFormat.format(dt.vaksin1.tot[0]*100/(dt.vaksin1.tot[0]+dt.vaksin2.tot[0]))+"%");
	$("#iD2_al3_tx3").text(numFormat.format(dt.vaksin2.tot[0]));
	$("#iD2_al3_tx4").text(numFormat.format(dt.vaksin2.tot[0]*100/(dt.vaksin1.tot[0]+dt.vaksin2.tot[0]))+"%");

	$("#iD2_al4_num").text(numFormat.format(dt.vaksin1.tot[0]*100/total.vax[0])+"%");
	$("#iD2_al5_num").text(numFormat.format(dt.vaksin2.tot[0]*100/total.vax[1])+"%");

	$("#iD2_wrapper").slideDown();
});

preFiltered.vax.sort(compare);
//console.log(preFiltered.vax);
var ur_dati2={"vax":[[],[],[],[]]};
$.each(["vax"], function(k1,v1) {
	$.each(preFiltered[v1], function(k,v) {
		ur_dati2[v1][0].push(v[4]); // Kabupaten 
		ur_dati2[v1][1].push(v[1]); // Vaksin 1
		ur_dati2[v1][2].push(v[2]); // Vaksin 2
		ur_dati2[v1][3].push(v[3]); // Target
	});
});
//console.log(ur_dati2);
const footer = (tooltipItems) => {
	let sum = 0;
	tooltipItems.forEach(function(tooltipItem) {sum += tooltipItem.parsed.y});
	return 'Jumlah: ' + numFormat.format(sum);
}
const c_label = function(context) {
	var label = context.dataset.label || '';
	if (label) { label += ': '; }
	if (context.parsed.y !== null) { label += numFormat.format(context.parsed.y); }
	return label;
}
const ct_y = function(v) {
	return numFormat.format(v);
}

await delay(500);
$(".map-fs-toggle").on("click", function() {
	if($("#peta_supercont").data("fs")==true) {
		$("body").css("overflow", "auto");
		$("#peta_supercont").removeClass("map-fs").data("fs", false);
	} else {
		$("body").css("overflow", "hidden");
		$("#peta_supercont").addClass("map-fs").data("fs", true);
	}
});
function showDataPerWil(id, perc, col, text=null) {
	var special_len = (text.match(/[,.]/g)||[]).length;
	var rect_w = (text.length - special_len)*8 + special_len*4 + 8;
	$("#map_style").append("#MapContainer path._data"+id+"{fill:"+rgba2rgb([255, 255, 255],[col[0], col[1], col[2], perc])+"!important}");
	$("#MapContainer path._data"+id).data("kode",id);
	$("#MapContainer .label_data"+id+">text").text(text);
	$("#MapContainer .label_data"+id+">rect").css({width: rect_w+"px"});
	delete special_len; delete rect_w;
}
function TmplDataPeta(mode){
	var title, min=0, mid=50, max=100, col=[0,0,0];
	$("#map_style").html("");
	$("[data-mapdata]").removeClass("active");
	$("[data-mapdata='"+mode+"']").addClass("active");
	if(mode===1) {
		title="Penambahan Penyuntikan Dosis 1";
		min = 0;
		mid = (H_Vax1inc/2).toFixed(0); 
		max = numFormat.format(H_Vax1inc);
		col = [32,201,151];
		$.each(data.dt_kab,function(k,v){
			per=(v.vaksin1.tot[0]-v.vaksin1.tot[1])/H_Vax1inc, text = numFormat.format(v.vaksin1.tot[0]-v.vaksin1.tot[1]);
			showDataPerWil(k, per, col, text);
		});
	}
	if(mode===2) {
		title="Persen Telah Divaksinasi Dosis 1";
		min = "0%";
		mid = numFormat.format(H_vax1rate*100/2)+"%"; 
		max = numFormat.format(H_vax1rate*100)+"%";
		col = [32,201,151];
		$.each(data.dt_kab,function(k,v){
			per=(v.vaksin1.tot[0]/v.target.total)/H_vax1rate, text = numFormat.format((v.vaksin1.tot[0]/v.target.total)*100)+"%";
			showDataPerWil(k, per, col, text);
		});
	}
	if(mode===3) {
		title="Penambahan Penyuntikan Dosis 2";
		min = 0;
		mid = (H_Vax2inc/2).toFixed(0); 
		max = numFormat.format(H_Vax2inc);
		col = [0,123,255];
		$.each(data.dt_kab,function(k,v){
			per=(v.vaksin2.tot[0]-v.vaksin2.tot[1])/H_Vax1inc, text = numFormat.format(v.vaksin2.tot[0]-v.vaksin2.tot[1]);
			showDataPerWil(k, per, col, text);
		});
	}
	if(mode===4) {
		title="Persen Telah Divaksinasi Dosis 2";
		min = "0%";
		mid = numFormat.format(H_vax2rate*100/2)+"%"; 
		max = numFormat.format(H_vax2rate*100)+"%";
		col = [0,123,255];
		$.each(data.dt_kab,function(k,v){
			per=(v.vaksin2.tot[0]/v.target.total)/H_vax2rate, text = numFormat.format((v.vaksin2.tot[0]/v.target.total)*100)+"%";
			showDataPerWil(k, per, col, text);
		});
	}
	$("#MapIndLeg>div>span:nth-child(1)").text(min);
	$("#MapIndLeg>div>span:nth-child(2)").text(mid);
	$("#MapIndLeg>div>span:nth-child(3)").text(max);
	$("#MapIndCol").css("background-image","linear-gradient(90deg, white, rgba("+col+"))");
	$("#MapTitle").text(title);
}
TmplDataPeta(2); // Default untuk peta
$("[data-mapdata]").on("click",function(){
	TmplDataPeta($(this).data("mapdata"));
});
// SHORT__SPINNER_PETA
$("#spinner_loader").fadeOut();

$(document).on("click","#MapContainer svg path[class*=_data]",function(e){
	var cldata = $(this).attr("class").match(/(_data)[0-9]*\w/g)[0];
	if(cldata.slice(5) && $(this).hasClass("kab_selected")==false) {
		$("#MapContainer #peta_utama>#svg_selected .kab_selected").remove();
		$('#MapContainer svg .'+cldata).clone().addClass("kab_selected").appendTo("#svg_selected");
		var kode = cldata.slice(5);
		$("#activewil").html("#MapContainer svg ."+cldata+".kab_selected{filter: drop-shadow(-1px 0px 0 #ffc107) drop-shadow(1px -1px 0 #ffc107) drop-shadow(-1px 1px 0 #ffc107) drop-shadow(1px 4px 0 #ffc107);}");
		var dt=data.dt_kab[kode];
		$("#ml_kab").text(dt.nama);
		$("#ml_anchor").data("kab", kode);
	}
});
function scroll2view(e){
	e.preventDefault();
	$("#peta_supercont").removeClass("map-fs").data("fs", false);
	$("body").css("overflow", "auto");
	$('html,body').animate({scrollTop: $("#Bg4_Kasus").offset().top}, 1000);
	var kode = $("#ml_anchor").data("kab");
	if(kode>=0 && kode<=21) {
		$("#selDati2").val(kode);
		$("#selDati2_show").click();
	}
}
$("#ml_anchor").on("click", scroll2view);
//$("#MapContainer svg path[class^='_data']").on("dblclick", scroll2view);

Chart.defaults.font.family = "Roboto";
var c_options={interaction: {mode: 'index', intersect: false}, plugins: {tooltip: {callbacks: {label: c_label}}}, scales: {x: {stacked: false}, y: {stacked: false, ticks:{callback: ct_y, beginAtZero: true}}}, elements: {line: {tension: 0}}, maintainAspectRatio: false};

await delay(1500);
$("#c_vax12").siblings("div").remove();
var data_vax = [
	{label: "Vaksin 1", data: ur_dati2.vax[1], backgroundColor: 'rgba(32,201,151,.7)', borderWidth: 0, categoryPercentage: .9},
	{label: "Vaksin 2", data: ur_dati2.vax[2], backgroundColor: 'rgba(0,123,255,.7)', borderWidth: 0, categoryPercentage: .9},
	{type: "line", label: "Target", data: ur_dati2.vax[3], backgroundColor: 'rgb(52,58,64,.7)'}
];
var c_vax12 = new Chart(document.getElementById("c_vax12").getContext("2d"), {
	type: 'bar',
	data: {labels: ur_dati2.vax[0], datasets: data_vax},
	options: c_options
});

}
</script>
</body>
</html>
